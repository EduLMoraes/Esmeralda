<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Source of the Rust file `/home/eduardo/.cargo/registry/src/index.crates.io-6f17d22bba15001f/rust-crypto-0.2.36/src/aessafe.rs`."><title>aessafe.rs - source</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-fa3bb1812debf86c.css"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="crypto" data-themes="" data-resource-suffix="" data-rustdoc-version="1.74.1 (a28077b28 2023-12-04)" data-channel="1.74.1" data-search-js="search-8be46b629f5f14a8.js" data-settings-js="settings-74424d7eec62a23e.js" ><script src="../../static.files/storage-fec3eaa3851e447d.js"></script><script defer src="../../static.files/src-script-3280b574d94e47b4.js"></script><script defer src="../../src-files.js"></script><script defer src="../../static.files/main-c5bd66d33317d69f.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-5d8b3c7633ad77ba.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc src"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"></nav><main><nav class="sub"><a class="sub-logo-container" href="../../crypto/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="example-wrap"><div data-nosnippet><pre class="src-line-numbers"><a href="#1" id="1">1</a>
<a href="#2" id="2">2</a>
<a href="#3" id="3">3</a>
<a href="#4" id="4">4</a>
<a href="#5" id="5">5</a>
<a href="#6" id="6">6</a>
<a href="#7" id="7">7</a>
<a href="#8" id="8">8</a>
<a href="#9" id="9">9</a>
<a href="#10" id="10">10</a>
<a href="#11" id="11">11</a>
<a href="#12" id="12">12</a>
<a href="#13" id="13">13</a>
<a href="#14" id="14">14</a>
<a href="#15" id="15">15</a>
<a href="#16" id="16">16</a>
<a href="#17" id="17">17</a>
<a href="#18" id="18">18</a>
<a href="#19" id="19">19</a>
<a href="#20" id="20">20</a>
<a href="#21" id="21">21</a>
<a href="#22" id="22">22</a>
<a href="#23" id="23">23</a>
<a href="#24" id="24">24</a>
<a href="#25" id="25">25</a>
<a href="#26" id="26">26</a>
<a href="#27" id="27">27</a>
<a href="#28" id="28">28</a>
<a href="#29" id="29">29</a>
<a href="#30" id="30">30</a>
<a href="#31" id="31">31</a>
<a href="#32" id="32">32</a>
<a href="#33" id="33">33</a>
<a href="#34" id="34">34</a>
<a href="#35" id="35">35</a>
<a href="#36" id="36">36</a>
<a href="#37" id="37">37</a>
<a href="#38" id="38">38</a>
<a href="#39" id="39">39</a>
<a href="#40" id="40">40</a>
<a href="#41" id="41">41</a>
<a href="#42" id="42">42</a>
<a href="#43" id="43">43</a>
<a href="#44" id="44">44</a>
<a href="#45" id="45">45</a>
<a href="#46" id="46">46</a>
<a href="#47" id="47">47</a>
<a href="#48" id="48">48</a>
<a href="#49" id="49">49</a>
<a href="#50" id="50">50</a>
<a href="#51" id="51">51</a>
<a href="#52" id="52">52</a>
<a href="#53" id="53">53</a>
<a href="#54" id="54">54</a>
<a href="#55" id="55">55</a>
<a href="#56" id="56">56</a>
<a href="#57" id="57">57</a>
<a href="#58" id="58">58</a>
<a href="#59" id="59">59</a>
<a href="#60" id="60">60</a>
<a href="#61" id="61">61</a>
<a href="#62" id="62">62</a>
<a href="#63" id="63">63</a>
<a href="#64" id="64">64</a>
<a href="#65" id="65">65</a>
<a href="#66" id="66">66</a>
<a href="#67" id="67">67</a>
<a href="#68" id="68">68</a>
<a href="#69" id="69">69</a>
<a href="#70" id="70">70</a>
<a href="#71" id="71">71</a>
<a href="#72" id="72">72</a>
<a href="#73" id="73">73</a>
<a href="#74" id="74">74</a>
<a href="#75" id="75">75</a>
<a href="#76" id="76">76</a>
<a href="#77" id="77">77</a>
<a href="#78" id="78">78</a>
<a href="#79" id="79">79</a>
<a href="#80" id="80">80</a>
<a href="#81" id="81">81</a>
<a href="#82" id="82">82</a>
<a href="#83" id="83">83</a>
<a href="#84" id="84">84</a>
<a href="#85" id="85">85</a>
<a href="#86" id="86">86</a>
<a href="#87" id="87">87</a>
<a href="#88" id="88">88</a>
<a href="#89" id="89">89</a>
<a href="#90" id="90">90</a>
<a href="#91" id="91">91</a>
<a href="#92" id="92">92</a>
<a href="#93" id="93">93</a>
<a href="#94" id="94">94</a>
<a href="#95" id="95">95</a>
<a href="#96" id="96">96</a>
<a href="#97" id="97">97</a>
<a href="#98" id="98">98</a>
<a href="#99" id="99">99</a>
<a href="#100" id="100">100</a>
<a href="#101" id="101">101</a>
<a href="#102" id="102">102</a>
<a href="#103" id="103">103</a>
<a href="#104" id="104">104</a>
<a href="#105" id="105">105</a>
<a href="#106" id="106">106</a>
<a href="#107" id="107">107</a>
<a href="#108" id="108">108</a>
<a href="#109" id="109">109</a>
<a href="#110" id="110">110</a>
<a href="#111" id="111">111</a>
<a href="#112" id="112">112</a>
<a href="#113" id="113">113</a>
<a href="#114" id="114">114</a>
<a href="#115" id="115">115</a>
<a href="#116" id="116">116</a>
<a href="#117" id="117">117</a>
<a href="#118" id="118">118</a>
<a href="#119" id="119">119</a>
<a href="#120" id="120">120</a>
<a href="#121" id="121">121</a>
<a href="#122" id="122">122</a>
<a href="#123" id="123">123</a>
<a href="#124" id="124">124</a>
<a href="#125" id="125">125</a>
<a href="#126" id="126">126</a>
<a href="#127" id="127">127</a>
<a href="#128" id="128">128</a>
<a href="#129" id="129">129</a>
<a href="#130" id="130">130</a>
<a href="#131" id="131">131</a>
<a href="#132" id="132">132</a>
<a href="#133" id="133">133</a>
<a href="#134" id="134">134</a>
<a href="#135" id="135">135</a>
<a href="#136" id="136">136</a>
<a href="#137" id="137">137</a>
<a href="#138" id="138">138</a>
<a href="#139" id="139">139</a>
<a href="#140" id="140">140</a>
<a href="#141" id="141">141</a>
<a href="#142" id="142">142</a>
<a href="#143" id="143">143</a>
<a href="#144" id="144">144</a>
<a href="#145" id="145">145</a>
<a href="#146" id="146">146</a>
<a href="#147" id="147">147</a>
<a href="#148" id="148">148</a>
<a href="#149" id="149">149</a>
<a href="#150" id="150">150</a>
<a href="#151" id="151">151</a>
<a href="#152" id="152">152</a>
<a href="#153" id="153">153</a>
<a href="#154" id="154">154</a>
<a href="#155" id="155">155</a>
<a href="#156" id="156">156</a>
<a href="#157" id="157">157</a>
<a href="#158" id="158">158</a>
<a href="#159" id="159">159</a>
<a href="#160" id="160">160</a>
<a href="#161" id="161">161</a>
<a href="#162" id="162">162</a>
<a href="#163" id="163">163</a>
<a href="#164" id="164">164</a>
<a href="#165" id="165">165</a>
<a href="#166" id="166">166</a>
<a href="#167" id="167">167</a>
<a href="#168" id="168">168</a>
<a href="#169" id="169">169</a>
<a href="#170" id="170">170</a>
<a href="#171" id="171">171</a>
<a href="#172" id="172">172</a>
<a href="#173" id="173">173</a>
<a href="#174" id="174">174</a>
<a href="#175" id="175">175</a>
<a href="#176" id="176">176</a>
<a href="#177" id="177">177</a>
<a href="#178" id="178">178</a>
<a href="#179" id="179">179</a>
<a href="#180" id="180">180</a>
<a href="#181" id="181">181</a>
<a href="#182" id="182">182</a>
<a href="#183" id="183">183</a>
<a href="#184" id="184">184</a>
<a href="#185" id="185">185</a>
<a href="#186" id="186">186</a>
<a href="#187" id="187">187</a>
<a href="#188" id="188">188</a>
<a href="#189" id="189">189</a>
<a href="#190" id="190">190</a>
<a href="#191" id="191">191</a>
<a href="#192" id="192">192</a>
<a href="#193" id="193">193</a>
<a href="#194" id="194">194</a>
<a href="#195" id="195">195</a>
<a href="#196" id="196">196</a>
<a href="#197" id="197">197</a>
<a href="#198" id="198">198</a>
<a href="#199" id="199">199</a>
<a href="#200" id="200">200</a>
<a href="#201" id="201">201</a>
<a href="#202" id="202">202</a>
<a href="#203" id="203">203</a>
<a href="#204" id="204">204</a>
<a href="#205" id="205">205</a>
<a href="#206" id="206">206</a>
<a href="#207" id="207">207</a>
<a href="#208" id="208">208</a>
<a href="#209" id="209">209</a>
<a href="#210" id="210">210</a>
<a href="#211" id="211">211</a>
<a href="#212" id="212">212</a>
<a href="#213" id="213">213</a>
<a href="#214" id="214">214</a>
<a href="#215" id="215">215</a>
<a href="#216" id="216">216</a>
<a href="#217" id="217">217</a>
<a href="#218" id="218">218</a>
<a href="#219" id="219">219</a>
<a href="#220" id="220">220</a>
<a href="#221" id="221">221</a>
<a href="#222" id="222">222</a>
<a href="#223" id="223">223</a>
<a href="#224" id="224">224</a>
<a href="#225" id="225">225</a>
<a href="#226" id="226">226</a>
<a href="#227" id="227">227</a>
<a href="#228" id="228">228</a>
<a href="#229" id="229">229</a>
<a href="#230" id="230">230</a>
<a href="#231" id="231">231</a>
<a href="#232" id="232">232</a>
<a href="#233" id="233">233</a>
<a href="#234" id="234">234</a>
<a href="#235" id="235">235</a>
<a href="#236" id="236">236</a>
<a href="#237" id="237">237</a>
<a href="#238" id="238">238</a>
<a href="#239" id="239">239</a>
<a href="#240" id="240">240</a>
<a href="#241" id="241">241</a>
<a href="#242" id="242">242</a>
<a href="#243" id="243">243</a>
<a href="#244" id="244">244</a>
<a href="#245" id="245">245</a>
<a href="#246" id="246">246</a>
<a href="#247" id="247">247</a>
<a href="#248" id="248">248</a>
<a href="#249" id="249">249</a>
<a href="#250" id="250">250</a>
<a href="#251" id="251">251</a>
<a href="#252" id="252">252</a>
<a href="#253" id="253">253</a>
<a href="#254" id="254">254</a>
<a href="#255" id="255">255</a>
<a href="#256" id="256">256</a>
<a href="#257" id="257">257</a>
<a href="#258" id="258">258</a>
<a href="#259" id="259">259</a>
<a href="#260" id="260">260</a>
<a href="#261" id="261">261</a>
<a href="#262" id="262">262</a>
<a href="#263" id="263">263</a>
<a href="#264" id="264">264</a>
<a href="#265" id="265">265</a>
<a href="#266" id="266">266</a>
<a href="#267" id="267">267</a>
<a href="#268" id="268">268</a>
<a href="#269" id="269">269</a>
<a href="#270" id="270">270</a>
<a href="#271" id="271">271</a>
<a href="#272" id="272">272</a>
<a href="#273" id="273">273</a>
<a href="#274" id="274">274</a>
<a href="#275" id="275">275</a>
<a href="#276" id="276">276</a>
<a href="#277" id="277">277</a>
<a href="#278" id="278">278</a>
<a href="#279" id="279">279</a>
<a href="#280" id="280">280</a>
<a href="#281" id="281">281</a>
<a href="#282" id="282">282</a>
<a href="#283" id="283">283</a>
<a href="#284" id="284">284</a>
<a href="#285" id="285">285</a>
<a href="#286" id="286">286</a>
<a href="#287" id="287">287</a>
<a href="#288" id="288">288</a>
<a href="#289" id="289">289</a>
<a href="#290" id="290">290</a>
<a href="#291" id="291">291</a>
<a href="#292" id="292">292</a>
<a href="#293" id="293">293</a>
<a href="#294" id="294">294</a>
<a href="#295" id="295">295</a>
<a href="#296" id="296">296</a>
<a href="#297" id="297">297</a>
<a href="#298" id="298">298</a>
<a href="#299" id="299">299</a>
<a href="#300" id="300">300</a>
<a href="#301" id="301">301</a>
<a href="#302" id="302">302</a>
<a href="#303" id="303">303</a>
<a href="#304" id="304">304</a>
<a href="#305" id="305">305</a>
<a href="#306" id="306">306</a>
<a href="#307" id="307">307</a>
<a href="#308" id="308">308</a>
<a href="#309" id="309">309</a>
<a href="#310" id="310">310</a>
<a href="#311" id="311">311</a>
<a href="#312" id="312">312</a>
<a href="#313" id="313">313</a>
<a href="#314" id="314">314</a>
<a href="#315" id="315">315</a>
<a href="#316" id="316">316</a>
<a href="#317" id="317">317</a>
<a href="#318" id="318">318</a>
<a href="#319" id="319">319</a>
<a href="#320" id="320">320</a>
<a href="#321" id="321">321</a>
<a href="#322" id="322">322</a>
<a href="#323" id="323">323</a>
<a href="#324" id="324">324</a>
<a href="#325" id="325">325</a>
<a href="#326" id="326">326</a>
<a href="#327" id="327">327</a>
<a href="#328" id="328">328</a>
<a href="#329" id="329">329</a>
<a href="#330" id="330">330</a>
<a href="#331" id="331">331</a>
<a href="#332" id="332">332</a>
<a href="#333" id="333">333</a>
<a href="#334" id="334">334</a>
<a href="#335" id="335">335</a>
<a href="#336" id="336">336</a>
<a href="#337" id="337">337</a>
<a href="#338" id="338">338</a>
<a href="#339" id="339">339</a>
<a href="#340" id="340">340</a>
<a href="#341" id="341">341</a>
<a href="#342" id="342">342</a>
<a href="#343" id="343">343</a>
<a href="#344" id="344">344</a>
<a href="#345" id="345">345</a>
<a href="#346" id="346">346</a>
<a href="#347" id="347">347</a>
<a href="#348" id="348">348</a>
<a href="#349" id="349">349</a>
<a href="#350" id="350">350</a>
<a href="#351" id="351">351</a>
<a href="#352" id="352">352</a>
<a href="#353" id="353">353</a>
<a href="#354" id="354">354</a>
<a href="#355" id="355">355</a>
<a href="#356" id="356">356</a>
<a href="#357" id="357">357</a>
<a href="#358" id="358">358</a>
<a href="#359" id="359">359</a>
<a href="#360" id="360">360</a>
<a href="#361" id="361">361</a>
<a href="#362" id="362">362</a>
<a href="#363" id="363">363</a>
<a href="#364" id="364">364</a>
<a href="#365" id="365">365</a>
<a href="#366" id="366">366</a>
<a href="#367" id="367">367</a>
<a href="#368" id="368">368</a>
<a href="#369" id="369">369</a>
<a href="#370" id="370">370</a>
<a href="#371" id="371">371</a>
<a href="#372" id="372">372</a>
<a href="#373" id="373">373</a>
<a href="#374" id="374">374</a>
<a href="#375" id="375">375</a>
<a href="#376" id="376">376</a>
<a href="#377" id="377">377</a>
<a href="#378" id="378">378</a>
<a href="#379" id="379">379</a>
<a href="#380" id="380">380</a>
<a href="#381" id="381">381</a>
<a href="#382" id="382">382</a>
<a href="#383" id="383">383</a>
<a href="#384" id="384">384</a>
<a href="#385" id="385">385</a>
<a href="#386" id="386">386</a>
<a href="#387" id="387">387</a>
<a href="#388" id="388">388</a>
<a href="#389" id="389">389</a>
<a href="#390" id="390">390</a>
<a href="#391" id="391">391</a>
<a href="#392" id="392">392</a>
<a href="#393" id="393">393</a>
<a href="#394" id="394">394</a>
<a href="#395" id="395">395</a>
<a href="#396" id="396">396</a>
<a href="#397" id="397">397</a>
<a href="#398" id="398">398</a>
<a href="#399" id="399">399</a>
<a href="#400" id="400">400</a>
<a href="#401" id="401">401</a>
<a href="#402" id="402">402</a>
<a href="#403" id="403">403</a>
<a href="#404" id="404">404</a>
<a href="#405" id="405">405</a>
<a href="#406" id="406">406</a>
<a href="#407" id="407">407</a>
<a href="#408" id="408">408</a>
<a href="#409" id="409">409</a>
<a href="#410" id="410">410</a>
<a href="#411" id="411">411</a>
<a href="#412" id="412">412</a>
<a href="#413" id="413">413</a>
<a href="#414" id="414">414</a>
<a href="#415" id="415">415</a>
<a href="#416" id="416">416</a>
<a href="#417" id="417">417</a>
<a href="#418" id="418">418</a>
<a href="#419" id="419">419</a>
<a href="#420" id="420">420</a>
<a href="#421" id="421">421</a>
<a href="#422" id="422">422</a>
<a href="#423" id="423">423</a>
<a href="#424" id="424">424</a>
<a href="#425" id="425">425</a>
<a href="#426" id="426">426</a>
<a href="#427" id="427">427</a>
<a href="#428" id="428">428</a>
<a href="#429" id="429">429</a>
<a href="#430" id="430">430</a>
<a href="#431" id="431">431</a>
<a href="#432" id="432">432</a>
<a href="#433" id="433">433</a>
<a href="#434" id="434">434</a>
<a href="#435" id="435">435</a>
<a href="#436" id="436">436</a>
<a href="#437" id="437">437</a>
<a href="#438" id="438">438</a>
<a href="#439" id="439">439</a>
<a href="#440" id="440">440</a>
<a href="#441" id="441">441</a>
<a href="#442" id="442">442</a>
<a href="#443" id="443">443</a>
<a href="#444" id="444">444</a>
<a href="#445" id="445">445</a>
<a href="#446" id="446">446</a>
<a href="#447" id="447">447</a>
<a href="#448" id="448">448</a>
<a href="#449" id="449">449</a>
<a href="#450" id="450">450</a>
<a href="#451" id="451">451</a>
<a href="#452" id="452">452</a>
<a href="#453" id="453">453</a>
<a href="#454" id="454">454</a>
<a href="#455" id="455">455</a>
<a href="#456" id="456">456</a>
<a href="#457" id="457">457</a>
<a href="#458" id="458">458</a>
<a href="#459" id="459">459</a>
<a href="#460" id="460">460</a>
<a href="#461" id="461">461</a>
<a href="#462" id="462">462</a>
<a href="#463" id="463">463</a>
<a href="#464" id="464">464</a>
<a href="#465" id="465">465</a>
<a href="#466" id="466">466</a>
<a href="#467" id="467">467</a>
<a href="#468" id="468">468</a>
<a href="#469" id="469">469</a>
<a href="#470" id="470">470</a>
<a href="#471" id="471">471</a>
<a href="#472" id="472">472</a>
<a href="#473" id="473">473</a>
<a href="#474" id="474">474</a>
<a href="#475" id="475">475</a>
<a href="#476" id="476">476</a>
<a href="#477" id="477">477</a>
<a href="#478" id="478">478</a>
<a href="#479" id="479">479</a>
<a href="#480" id="480">480</a>
<a href="#481" id="481">481</a>
<a href="#482" id="482">482</a>
<a href="#483" id="483">483</a>
<a href="#484" id="484">484</a>
<a href="#485" id="485">485</a>
<a href="#486" id="486">486</a>
<a href="#487" id="487">487</a>
<a href="#488" id="488">488</a>
<a href="#489" id="489">489</a>
<a href="#490" id="490">490</a>
<a href="#491" id="491">491</a>
<a href="#492" id="492">492</a>
<a href="#493" id="493">493</a>
<a href="#494" id="494">494</a>
<a href="#495" id="495">495</a>
<a href="#496" id="496">496</a>
<a href="#497" id="497">497</a>
<a href="#498" id="498">498</a>
<a href="#499" id="499">499</a>
<a href="#500" id="500">500</a>
<a href="#501" id="501">501</a>
<a href="#502" id="502">502</a>
<a href="#503" id="503">503</a>
<a href="#504" id="504">504</a>
<a href="#505" id="505">505</a>
<a href="#506" id="506">506</a>
<a href="#507" id="507">507</a>
<a href="#508" id="508">508</a>
<a href="#509" id="509">509</a>
<a href="#510" id="510">510</a>
<a href="#511" id="511">511</a>
<a href="#512" id="512">512</a>
<a href="#513" id="513">513</a>
<a href="#514" id="514">514</a>
<a href="#515" id="515">515</a>
<a href="#516" id="516">516</a>
<a href="#517" id="517">517</a>
<a href="#518" id="518">518</a>
<a href="#519" id="519">519</a>
<a href="#520" id="520">520</a>
<a href="#521" id="521">521</a>
<a href="#522" id="522">522</a>
<a href="#523" id="523">523</a>
<a href="#524" id="524">524</a>
<a href="#525" id="525">525</a>
<a href="#526" id="526">526</a>
<a href="#527" id="527">527</a>
<a href="#528" id="528">528</a>
<a href="#529" id="529">529</a>
<a href="#530" id="530">530</a>
<a href="#531" id="531">531</a>
<a href="#532" id="532">532</a>
<a href="#533" id="533">533</a>
<a href="#534" id="534">534</a>
<a href="#535" id="535">535</a>
<a href="#536" id="536">536</a>
<a href="#537" id="537">537</a>
<a href="#538" id="538">538</a>
<a href="#539" id="539">539</a>
<a href="#540" id="540">540</a>
<a href="#541" id="541">541</a>
<a href="#542" id="542">542</a>
<a href="#543" id="543">543</a>
<a href="#544" id="544">544</a>
<a href="#545" id="545">545</a>
<a href="#546" id="546">546</a>
<a href="#547" id="547">547</a>
<a href="#548" id="548">548</a>
<a href="#549" id="549">549</a>
<a href="#550" id="550">550</a>
<a href="#551" id="551">551</a>
<a href="#552" id="552">552</a>
<a href="#553" id="553">553</a>
<a href="#554" id="554">554</a>
<a href="#555" id="555">555</a>
<a href="#556" id="556">556</a>
<a href="#557" id="557">557</a>
<a href="#558" id="558">558</a>
<a href="#559" id="559">559</a>
<a href="#560" id="560">560</a>
<a href="#561" id="561">561</a>
<a href="#562" id="562">562</a>
<a href="#563" id="563">563</a>
<a href="#564" id="564">564</a>
<a href="#565" id="565">565</a>
<a href="#566" id="566">566</a>
<a href="#567" id="567">567</a>
<a href="#568" id="568">568</a>
<a href="#569" id="569">569</a>
<a href="#570" id="570">570</a>
<a href="#571" id="571">571</a>
<a href="#572" id="572">572</a>
<a href="#573" id="573">573</a>
<a href="#574" id="574">574</a>
<a href="#575" id="575">575</a>
<a href="#576" id="576">576</a>
<a href="#577" id="577">577</a>
<a href="#578" id="578">578</a>
<a href="#579" id="579">579</a>
<a href="#580" id="580">580</a>
<a href="#581" id="581">581</a>
<a href="#582" id="582">582</a>
<a href="#583" id="583">583</a>
<a href="#584" id="584">584</a>
<a href="#585" id="585">585</a>
<a href="#586" id="586">586</a>
<a href="#587" id="587">587</a>
<a href="#588" id="588">588</a>
<a href="#589" id="589">589</a>
<a href="#590" id="590">590</a>
<a href="#591" id="591">591</a>
<a href="#592" id="592">592</a>
<a href="#593" id="593">593</a>
<a href="#594" id="594">594</a>
<a href="#595" id="595">595</a>
<a href="#596" id="596">596</a>
<a href="#597" id="597">597</a>
<a href="#598" id="598">598</a>
<a href="#599" id="599">599</a>
<a href="#600" id="600">600</a>
<a href="#601" id="601">601</a>
<a href="#602" id="602">602</a>
<a href="#603" id="603">603</a>
<a href="#604" id="604">604</a>
<a href="#605" id="605">605</a>
<a href="#606" id="606">606</a>
<a href="#607" id="607">607</a>
<a href="#608" id="608">608</a>
<a href="#609" id="609">609</a>
<a href="#610" id="610">610</a>
<a href="#611" id="611">611</a>
<a href="#612" id="612">612</a>
<a href="#613" id="613">613</a>
<a href="#614" id="614">614</a>
<a href="#615" id="615">615</a>
<a href="#616" id="616">616</a>
<a href="#617" id="617">617</a>
<a href="#618" id="618">618</a>
<a href="#619" id="619">619</a>
<a href="#620" id="620">620</a>
<a href="#621" id="621">621</a>
<a href="#622" id="622">622</a>
<a href="#623" id="623">623</a>
<a href="#624" id="624">624</a>
<a href="#625" id="625">625</a>
<a href="#626" id="626">626</a>
<a href="#627" id="627">627</a>
<a href="#628" id="628">628</a>
<a href="#629" id="629">629</a>
<a href="#630" id="630">630</a>
<a href="#631" id="631">631</a>
<a href="#632" id="632">632</a>
<a href="#633" id="633">633</a>
<a href="#634" id="634">634</a>
<a href="#635" id="635">635</a>
<a href="#636" id="636">636</a>
<a href="#637" id="637">637</a>
<a href="#638" id="638">638</a>
<a href="#639" id="639">639</a>
<a href="#640" id="640">640</a>
<a href="#641" id="641">641</a>
<a href="#642" id="642">642</a>
<a href="#643" id="643">643</a>
<a href="#644" id="644">644</a>
<a href="#645" id="645">645</a>
<a href="#646" id="646">646</a>
<a href="#647" id="647">647</a>
<a href="#648" id="648">648</a>
<a href="#649" id="649">649</a>
<a href="#650" id="650">650</a>
<a href="#651" id="651">651</a>
<a href="#652" id="652">652</a>
<a href="#653" id="653">653</a>
<a href="#654" id="654">654</a>
<a href="#655" id="655">655</a>
<a href="#656" id="656">656</a>
<a href="#657" id="657">657</a>
<a href="#658" id="658">658</a>
<a href="#659" id="659">659</a>
<a href="#660" id="660">660</a>
<a href="#661" id="661">661</a>
<a href="#662" id="662">662</a>
<a href="#663" id="663">663</a>
<a href="#664" id="664">664</a>
<a href="#665" id="665">665</a>
<a href="#666" id="666">666</a>
<a href="#667" id="667">667</a>
<a href="#668" id="668">668</a>
<a href="#669" id="669">669</a>
<a href="#670" id="670">670</a>
<a href="#671" id="671">671</a>
<a href="#672" id="672">672</a>
<a href="#673" id="673">673</a>
<a href="#674" id="674">674</a>
<a href="#675" id="675">675</a>
<a href="#676" id="676">676</a>
<a href="#677" id="677">677</a>
<a href="#678" id="678">678</a>
<a href="#679" id="679">679</a>
<a href="#680" id="680">680</a>
<a href="#681" id="681">681</a>
<a href="#682" id="682">682</a>
<a href="#683" id="683">683</a>
<a href="#684" id="684">684</a>
<a href="#685" id="685">685</a>
<a href="#686" id="686">686</a>
<a href="#687" id="687">687</a>
<a href="#688" id="688">688</a>
<a href="#689" id="689">689</a>
<a href="#690" id="690">690</a>
<a href="#691" id="691">691</a>
<a href="#692" id="692">692</a>
<a href="#693" id="693">693</a>
<a href="#694" id="694">694</a>
<a href="#695" id="695">695</a>
<a href="#696" id="696">696</a>
<a href="#697" id="697">697</a>
<a href="#698" id="698">698</a>
<a href="#699" id="699">699</a>
<a href="#700" id="700">700</a>
<a href="#701" id="701">701</a>
<a href="#702" id="702">702</a>
<a href="#703" id="703">703</a>
<a href="#704" id="704">704</a>
<a href="#705" id="705">705</a>
<a href="#706" id="706">706</a>
<a href="#707" id="707">707</a>
<a href="#708" id="708">708</a>
<a href="#709" id="709">709</a>
<a href="#710" id="710">710</a>
<a href="#711" id="711">711</a>
<a href="#712" id="712">712</a>
<a href="#713" id="713">713</a>
<a href="#714" id="714">714</a>
<a href="#715" id="715">715</a>
<a href="#716" id="716">716</a>
<a href="#717" id="717">717</a>
<a href="#718" id="718">718</a>
<a href="#719" id="719">719</a>
<a href="#720" id="720">720</a>
<a href="#721" id="721">721</a>
<a href="#722" id="722">722</a>
<a href="#723" id="723">723</a>
<a href="#724" id="724">724</a>
<a href="#725" id="725">725</a>
<a href="#726" id="726">726</a>
<a href="#727" id="727">727</a>
<a href="#728" id="728">728</a>
<a href="#729" id="729">729</a>
<a href="#730" id="730">730</a>
<a href="#731" id="731">731</a>
<a href="#732" id="732">732</a>
<a href="#733" id="733">733</a>
<a href="#734" id="734">734</a>
<a href="#735" id="735">735</a>
<a href="#736" id="736">736</a>
<a href="#737" id="737">737</a>
<a href="#738" id="738">738</a>
<a href="#739" id="739">739</a>
<a href="#740" id="740">740</a>
<a href="#741" id="741">741</a>
<a href="#742" id="742">742</a>
<a href="#743" id="743">743</a>
<a href="#744" id="744">744</a>
<a href="#745" id="745">745</a>
<a href="#746" id="746">746</a>
<a href="#747" id="747">747</a>
<a href="#748" id="748">748</a>
<a href="#749" id="749">749</a>
<a href="#750" id="750">750</a>
<a href="#751" id="751">751</a>
<a href="#752" id="752">752</a>
<a href="#753" id="753">753</a>
<a href="#754" id="754">754</a>
<a href="#755" id="755">755</a>
<a href="#756" id="756">756</a>
<a href="#757" id="757">757</a>
<a href="#758" id="758">758</a>
<a href="#759" id="759">759</a>
<a href="#760" id="760">760</a>
<a href="#761" id="761">761</a>
<a href="#762" id="762">762</a>
<a href="#763" id="763">763</a>
<a href="#764" id="764">764</a>
<a href="#765" id="765">765</a>
<a href="#766" id="766">766</a>
<a href="#767" id="767">767</a>
<a href="#768" id="768">768</a>
<a href="#769" id="769">769</a>
<a href="#770" id="770">770</a>
<a href="#771" id="771">771</a>
<a href="#772" id="772">772</a>
<a href="#773" id="773">773</a>
<a href="#774" id="774">774</a>
<a href="#775" id="775">775</a>
<a href="#776" id="776">776</a>
<a href="#777" id="777">777</a>
<a href="#778" id="778">778</a>
<a href="#779" id="779">779</a>
<a href="#780" id="780">780</a>
<a href="#781" id="781">781</a>
<a href="#782" id="782">782</a>
<a href="#783" id="783">783</a>
<a href="#784" id="784">784</a>
<a href="#785" id="785">785</a>
<a href="#786" id="786">786</a>
<a href="#787" id="787">787</a>
<a href="#788" id="788">788</a>
<a href="#789" id="789">789</a>
<a href="#790" id="790">790</a>
<a href="#791" id="791">791</a>
<a href="#792" id="792">792</a>
<a href="#793" id="793">793</a>
<a href="#794" id="794">794</a>
<a href="#795" id="795">795</a>
<a href="#796" id="796">796</a>
<a href="#797" id="797">797</a>
<a href="#798" id="798">798</a>
<a href="#799" id="799">799</a>
<a href="#800" id="800">800</a>
<a href="#801" id="801">801</a>
<a href="#802" id="802">802</a>
<a href="#803" id="803">803</a>
<a href="#804" id="804">804</a>
<a href="#805" id="805">805</a>
<a href="#806" id="806">806</a>
<a href="#807" id="807">807</a>
<a href="#808" id="808">808</a>
<a href="#809" id="809">809</a>
<a href="#810" id="810">810</a>
<a href="#811" id="811">811</a>
<a href="#812" id="812">812</a>
<a href="#813" id="813">813</a>
<a href="#814" id="814">814</a>
<a href="#815" id="815">815</a>
<a href="#816" id="816">816</a>
<a href="#817" id="817">817</a>
<a href="#818" id="818">818</a>
<a href="#819" id="819">819</a>
<a href="#820" id="820">820</a>
<a href="#821" id="821">821</a>
<a href="#822" id="822">822</a>
<a href="#823" id="823">823</a>
<a href="#824" id="824">824</a>
<a href="#825" id="825">825</a>
<a href="#826" id="826">826</a>
<a href="#827" id="827">827</a>
<a href="#828" id="828">828</a>
<a href="#829" id="829">829</a>
<a href="#830" id="830">830</a>
<a href="#831" id="831">831</a>
<a href="#832" id="832">832</a>
<a href="#833" id="833">833</a>
<a href="#834" id="834">834</a>
<a href="#835" id="835">835</a>
<a href="#836" id="836">836</a>
<a href="#837" id="837">837</a>
<a href="#838" id="838">838</a>
<a href="#839" id="839">839</a>
<a href="#840" id="840">840</a>
<a href="#841" id="841">841</a>
<a href="#842" id="842">842</a>
<a href="#843" id="843">843</a>
<a href="#844" id="844">844</a>
<a href="#845" id="845">845</a>
<a href="#846" id="846">846</a>
<a href="#847" id="847">847</a>
<a href="#848" id="848">848</a>
<a href="#849" id="849">849</a>
<a href="#850" id="850">850</a>
<a href="#851" id="851">851</a>
<a href="#852" id="852">852</a>
<a href="#853" id="853">853</a>
<a href="#854" id="854">854</a>
<a href="#855" id="855">855</a>
<a href="#856" id="856">856</a>
<a href="#857" id="857">857</a>
<a href="#858" id="858">858</a>
<a href="#859" id="859">859</a>
<a href="#860" id="860">860</a>
<a href="#861" id="861">861</a>
<a href="#862" id="862">862</a>
<a href="#863" id="863">863</a>
<a href="#864" id="864">864</a>
<a href="#865" id="865">865</a>
<a href="#866" id="866">866</a>
<a href="#867" id="867">867</a>
<a href="#868" id="868">868</a>
<a href="#869" id="869">869</a>
<a href="#870" id="870">870</a>
<a href="#871" id="871">871</a>
<a href="#872" id="872">872</a>
<a href="#873" id="873">873</a>
<a href="#874" id="874">874</a>
<a href="#875" id="875">875</a>
<a href="#876" id="876">876</a>
<a href="#877" id="877">877</a>
<a href="#878" id="878">878</a>
<a href="#879" id="879">879</a>
<a href="#880" id="880">880</a>
<a href="#881" id="881">881</a>
<a href="#882" id="882">882</a>
<a href="#883" id="883">883</a>
<a href="#884" id="884">884</a>
<a href="#885" id="885">885</a>
<a href="#886" id="886">886</a>
<a href="#887" id="887">887</a>
<a href="#888" id="888">888</a>
<a href="#889" id="889">889</a>
<a href="#890" id="890">890</a>
<a href="#891" id="891">891</a>
<a href="#892" id="892">892</a>
<a href="#893" id="893">893</a>
<a href="#894" id="894">894</a>
<a href="#895" id="895">895</a>
<a href="#896" id="896">896</a>
<a href="#897" id="897">897</a>
<a href="#898" id="898">898</a>
<a href="#899" id="899">899</a>
<a href="#900" id="900">900</a>
<a href="#901" id="901">901</a>
<a href="#902" id="902">902</a>
<a href="#903" id="903">903</a>
<a href="#904" id="904">904</a>
<a href="#905" id="905">905</a>
<a href="#906" id="906">906</a>
<a href="#907" id="907">907</a>
<a href="#908" id="908">908</a>
<a href="#909" id="909">909</a>
<a href="#910" id="910">910</a>
<a href="#911" id="911">911</a>
<a href="#912" id="912">912</a>
<a href="#913" id="913">913</a>
<a href="#914" id="914">914</a>
<a href="#915" id="915">915</a>
<a href="#916" id="916">916</a>
<a href="#917" id="917">917</a>
<a href="#918" id="918">918</a>
<a href="#919" id="919">919</a>
<a href="#920" id="920">920</a>
<a href="#921" id="921">921</a>
<a href="#922" id="922">922</a>
<a href="#923" id="923">923</a>
<a href="#924" id="924">924</a>
<a href="#925" id="925">925</a>
<a href="#926" id="926">926</a>
<a href="#927" id="927">927</a>
<a href="#928" id="928">928</a>
<a href="#929" id="929">929</a>
<a href="#930" id="930">930</a>
<a href="#931" id="931">931</a>
<a href="#932" id="932">932</a>
<a href="#933" id="933">933</a>
<a href="#934" id="934">934</a>
<a href="#935" id="935">935</a>
<a href="#936" id="936">936</a>
<a href="#937" id="937">937</a>
<a href="#938" id="938">938</a>
<a href="#939" id="939">939</a>
<a href="#940" id="940">940</a>
<a href="#941" id="941">941</a>
<a href="#942" id="942">942</a>
<a href="#943" id="943">943</a>
<a href="#944" id="944">944</a>
<a href="#945" id="945">945</a>
<a href="#946" id="946">946</a>
<a href="#947" id="947">947</a>
<a href="#948" id="948">948</a>
<a href="#949" id="949">949</a>
<a href="#950" id="950">950</a>
<a href="#951" id="951">951</a>
<a href="#952" id="952">952</a>
<a href="#953" id="953">953</a>
<a href="#954" id="954">954</a>
<a href="#955" id="955">955</a>
<a href="#956" id="956">956</a>
<a href="#957" id="957">957</a>
<a href="#958" id="958">958</a>
<a href="#959" id="959">959</a>
<a href="#960" id="960">960</a>
<a href="#961" id="961">961</a>
<a href="#962" id="962">962</a>
<a href="#963" id="963">963</a>
<a href="#964" id="964">964</a>
<a href="#965" id="965">965</a>
<a href="#966" id="966">966</a>
<a href="#967" id="967">967</a>
<a href="#968" id="968">968</a>
<a href="#969" id="969">969</a>
<a href="#970" id="970">970</a>
<a href="#971" id="971">971</a>
<a href="#972" id="972">972</a>
<a href="#973" id="973">973</a>
<a href="#974" id="974">974</a>
<a href="#975" id="975">975</a>
<a href="#976" id="976">976</a>
<a href="#977" id="977">977</a>
<a href="#978" id="978">978</a>
<a href="#979" id="979">979</a>
<a href="#980" id="980">980</a>
<a href="#981" id="981">981</a>
<a href="#982" id="982">982</a>
<a href="#983" id="983">983</a>
<a href="#984" id="984">984</a>
<a href="#985" id="985">985</a>
<a href="#986" id="986">986</a>
<a href="#987" id="987">987</a>
<a href="#988" id="988">988</a>
<a href="#989" id="989">989</a>
<a href="#990" id="990">990</a>
<a href="#991" id="991">991</a>
<a href="#992" id="992">992</a>
<a href="#993" id="993">993</a>
<a href="#994" id="994">994</a>
<a href="#995" id="995">995</a>
<a href="#996" id="996">996</a>
<a href="#997" id="997">997</a>
<a href="#998" id="998">998</a>
<a href="#999" id="999">999</a>
<a href="#1000" id="1000">1000</a>
<a href="#1001" id="1001">1001</a>
<a href="#1002" id="1002">1002</a>
<a href="#1003" id="1003">1003</a>
<a href="#1004" id="1004">1004</a>
<a href="#1005" id="1005">1005</a>
<a href="#1006" id="1006">1006</a>
<a href="#1007" id="1007">1007</a>
<a href="#1008" id="1008">1008</a>
<a href="#1009" id="1009">1009</a>
<a href="#1010" id="1010">1010</a>
<a href="#1011" id="1011">1011</a>
<a href="#1012" id="1012">1012</a>
<a href="#1013" id="1013">1013</a>
<a href="#1014" id="1014">1014</a>
<a href="#1015" id="1015">1015</a>
<a href="#1016" id="1016">1016</a>
<a href="#1017" id="1017">1017</a>
<a href="#1018" id="1018">1018</a>
<a href="#1019" id="1019">1019</a>
<a href="#1020" id="1020">1020</a>
<a href="#1021" id="1021">1021</a>
<a href="#1022" id="1022">1022</a>
<a href="#1023" id="1023">1023</a>
<a href="#1024" id="1024">1024</a>
<a href="#1025" id="1025">1025</a>
<a href="#1026" id="1026">1026</a>
<a href="#1027" id="1027">1027</a>
<a href="#1028" id="1028">1028</a>
<a href="#1029" id="1029">1029</a>
<a href="#1030" id="1030">1030</a>
<a href="#1031" id="1031">1031</a>
<a href="#1032" id="1032">1032</a>
<a href="#1033" id="1033">1033</a>
<a href="#1034" id="1034">1034</a>
<a href="#1035" id="1035">1035</a>
<a href="#1036" id="1036">1036</a>
<a href="#1037" id="1037">1037</a>
<a href="#1038" id="1038">1038</a>
<a href="#1039" id="1039">1039</a>
<a href="#1040" id="1040">1040</a>
<a href="#1041" id="1041">1041</a>
<a href="#1042" id="1042">1042</a>
<a href="#1043" id="1043">1043</a>
<a href="#1044" id="1044">1044</a>
<a href="#1045" id="1045">1045</a>
<a href="#1046" id="1046">1046</a>
<a href="#1047" id="1047">1047</a>
<a href="#1048" id="1048">1048</a>
<a href="#1049" id="1049">1049</a>
<a href="#1050" id="1050">1050</a>
<a href="#1051" id="1051">1051</a>
<a href="#1052" id="1052">1052</a>
<a href="#1053" id="1053">1053</a>
<a href="#1054" id="1054">1054</a>
<a href="#1055" id="1055">1055</a>
<a href="#1056" id="1056">1056</a>
<a href="#1057" id="1057">1057</a>
<a href="#1058" id="1058">1058</a>
<a href="#1059" id="1059">1059</a>
<a href="#1060" id="1060">1060</a>
<a href="#1061" id="1061">1061</a>
<a href="#1062" id="1062">1062</a>
<a href="#1063" id="1063">1063</a>
<a href="#1064" id="1064">1064</a>
<a href="#1065" id="1065">1065</a>
<a href="#1066" id="1066">1066</a>
<a href="#1067" id="1067">1067</a>
<a href="#1068" id="1068">1068</a>
<a href="#1069" id="1069">1069</a>
<a href="#1070" id="1070">1070</a>
<a href="#1071" id="1071">1071</a>
<a href="#1072" id="1072">1072</a>
<a href="#1073" id="1073">1073</a>
<a href="#1074" id="1074">1074</a>
<a href="#1075" id="1075">1075</a>
<a href="#1076" id="1076">1076</a>
<a href="#1077" id="1077">1077</a>
<a href="#1078" id="1078">1078</a>
<a href="#1079" id="1079">1079</a>
<a href="#1080" id="1080">1080</a>
<a href="#1081" id="1081">1081</a>
<a href="#1082" id="1082">1082</a>
<a href="#1083" id="1083">1083</a>
<a href="#1084" id="1084">1084</a>
<a href="#1085" id="1085">1085</a>
<a href="#1086" id="1086">1086</a>
<a href="#1087" id="1087">1087</a>
<a href="#1088" id="1088">1088</a>
<a href="#1089" id="1089">1089</a>
<a href="#1090" id="1090">1090</a>
<a href="#1091" id="1091">1091</a>
<a href="#1092" id="1092">1092</a>
<a href="#1093" id="1093">1093</a>
<a href="#1094" id="1094">1094</a>
<a href="#1095" id="1095">1095</a>
<a href="#1096" id="1096">1096</a>
<a href="#1097" id="1097">1097</a>
<a href="#1098" id="1098">1098</a>
<a href="#1099" id="1099">1099</a>
<a href="#1100" id="1100">1100</a>
<a href="#1101" id="1101">1101</a>
<a href="#1102" id="1102">1102</a>
<a href="#1103" id="1103">1103</a>
<a href="#1104" id="1104">1104</a>
<a href="#1105" id="1105">1105</a>
<a href="#1106" id="1106">1106</a>
<a href="#1107" id="1107">1107</a>
<a href="#1108" id="1108">1108</a>
<a href="#1109" id="1109">1109</a>
<a href="#1110" id="1110">1110</a>
<a href="#1111" id="1111">1111</a>
<a href="#1112" id="1112">1112</a>
<a href="#1113" id="1113">1113</a>
<a href="#1114" id="1114">1114</a>
<a href="#1115" id="1115">1115</a>
<a href="#1116" id="1116">1116</a>
<a href="#1117" id="1117">1117</a>
<a href="#1118" id="1118">1118</a>
<a href="#1119" id="1119">1119</a>
<a href="#1120" id="1120">1120</a>
<a href="#1121" id="1121">1121</a>
<a href="#1122" id="1122">1122</a>
<a href="#1123" id="1123">1123</a>
<a href="#1124" id="1124">1124</a>
<a href="#1125" id="1125">1125</a>
<a href="#1126" id="1126">1126</a>
<a href="#1127" id="1127">1127</a>
<a href="#1128" id="1128">1128</a>
<a href="#1129" id="1129">1129</a>
<a href="#1130" id="1130">1130</a>
<a href="#1131" id="1131">1131</a>
<a href="#1132" id="1132">1132</a>
<a href="#1133" id="1133">1133</a>
<a href="#1134" id="1134">1134</a>
<a href="#1135" id="1135">1135</a>
<a href="#1136" id="1136">1136</a>
<a href="#1137" id="1137">1137</a>
<a href="#1138" id="1138">1138</a>
<a href="#1139" id="1139">1139</a>
<a href="#1140" id="1140">1140</a>
<a href="#1141" id="1141">1141</a>
<a href="#1142" id="1142">1142</a>
<a href="#1143" id="1143">1143</a>
<a href="#1144" id="1144">1144</a>
<a href="#1145" id="1145">1145</a>
<a href="#1146" id="1146">1146</a>
<a href="#1147" id="1147">1147</a>
<a href="#1148" id="1148">1148</a>
<a href="#1149" id="1149">1149</a>
<a href="#1150" id="1150">1150</a>
<a href="#1151" id="1151">1151</a>
<a href="#1152" id="1152">1152</a>
<a href="#1153" id="1153">1153</a>
<a href="#1154" id="1154">1154</a>
<a href="#1155" id="1155">1155</a>
<a href="#1156" id="1156">1156</a>
<a href="#1157" id="1157">1157</a>
<a href="#1158" id="1158">1158</a>
<a href="#1159" id="1159">1159</a>
<a href="#1160" id="1160">1160</a>
<a href="#1161" id="1161">1161</a>
<a href="#1162" id="1162">1162</a>
<a href="#1163" id="1163">1163</a>
<a href="#1164" id="1164">1164</a>
<a href="#1165" id="1165">1165</a>
<a href="#1166" id="1166">1166</a>
<a href="#1167" id="1167">1167</a>
<a href="#1168" id="1168">1168</a>
<a href="#1169" id="1169">1169</a>
<a href="#1170" id="1170">1170</a>
<a href="#1171" id="1171">1171</a>
<a href="#1172" id="1172">1172</a>
<a href="#1173" id="1173">1173</a>
<a href="#1174" id="1174">1174</a>
<a href="#1175" id="1175">1175</a>
<a href="#1176" id="1176">1176</a>
<a href="#1177" id="1177">1177</a>
<a href="#1178" id="1178">1178</a>
<a href="#1179" id="1179">1179</a>
<a href="#1180" id="1180">1180</a>
<a href="#1181" id="1181">1181</a>
<a href="#1182" id="1182">1182</a>
<a href="#1183" id="1183">1183</a>
<a href="#1184" id="1184">1184</a>
<a href="#1185" id="1185">1185</a>
<a href="#1186" id="1186">1186</a>
<a href="#1187" id="1187">1187</a>
<a href="#1188" id="1188">1188</a>
<a href="#1189" id="1189">1189</a>
<a href="#1190" id="1190">1190</a>
<a href="#1191" id="1191">1191</a>
<a href="#1192" id="1192">1192</a>
<a href="#1193" id="1193">1193</a>
<a href="#1194" id="1194">1194</a>
<a href="#1195" id="1195">1195</a>
<a href="#1196" id="1196">1196</a>
<a href="#1197" id="1197">1197</a>
<a href="#1198" id="1198">1198</a>
<a href="#1199" id="1199">1199</a>
<a href="#1200" id="1200">1200</a>
<a href="#1201" id="1201">1201</a>
<a href="#1202" id="1202">1202</a>
<a href="#1203" id="1203">1203</a>
<a href="#1204" id="1204">1204</a>
<a href="#1205" id="1205">1205</a>
<a href="#1206" id="1206">1206</a>
<a href="#1207" id="1207">1207</a>
<a href="#1208" id="1208">1208</a>
<a href="#1209" id="1209">1209</a>
<a href="#1210" id="1210">1210</a>
<a href="#1211" id="1211">1211</a>
<a href="#1212" id="1212">1212</a>
<a href="#1213" id="1213">1213</a>
<a href="#1214" id="1214">1214</a>
<a href="#1215" id="1215">1215</a>
<a href="#1216" id="1216">1216</a>
<a href="#1217" id="1217">1217</a>
<a href="#1218" id="1218">1218</a>
<a href="#1219" id="1219">1219</a>
<a href="#1220" id="1220">1220</a>
<a href="#1221" id="1221">1221</a>
<a href="#1222" id="1222">1222</a>
<a href="#1223" id="1223">1223</a>
<a href="#1224" id="1224">1224</a>
<a href="#1225" id="1225">1225</a>
<a href="#1226" id="1226">1226</a>
<a href="#1227" id="1227">1227</a>
<a href="#1228" id="1228">1228</a>
<a href="#1229" id="1229">1229</a>
<a href="#1230" id="1230">1230</a>
<a href="#1231" id="1231">1231</a>
</pre></div><pre class="rust"><code><span class="comment">// Licensed under the Apache License, Version 2.0 &lt;LICENSE-APACHE or
// http://www.apache.org/licenses/LICENSE-2.0&gt; or the MIT license
// &lt;LICENSE-MIT or http://opensource.org/licenses/MIT&gt;, at your
// option. This file may not be copied, modified, or distributed
// except according to those terms.

</span><span class="doccomment">/*!

The `aessafe` module implements the AES algorithm completely in software without using any table
lookups or other timing dependant mechanisms. This module actually contains two seperate
implementations - an implementation that works on a single block at a time and a second
implementation that processes 8 blocks in parallel. Some block encryption modes really only work if
you are processing a single blocks (CFB, OFB, and CBC encryption for example) while other modes
are trivially parallelizable (CTR and CBC decryption). Processing more blocks at once allows for
greater efficiency, especially when using wide registers, such as the XMM registers available in
x86 processors.

## AES Algorithm

There are lots of places to go to on the internet for an involved description of how AES works. For
the purposes of this description, it sufficies to say that AES is just a block cipher that takes
a key of 16, 24, or 32 bytes and uses that to either encrypt or decrypt a block of 16 bytes. An
encryption or decryption operation consists of a number of rounds which involve some combination of
the following 4 basic operations:

* ShiftRows
* MixColumns
* SubBytes
* AddRoundKey

## Timing problems

Most software implementations of AES use a large set of lookup tables - generally at least the
SubBytes step is implemented via lookup tables; faster implementations generally implement the
MixColumns step this way as well. This is largely a design flaw in the AES implementation as it was
not realized during the NIST standardization process that table lookups can lead to security
problems [1]. The issue is that not all table lookups occur in constant time - an address that was
recently used is looked up much faster than one that hasn&#39;t been used in a while. A careful
adversary can measure the amount of time that each AES operation takes and use that information to
help determine the secret key or plain text information. More specifically, its not table lookups
that lead to these types of timing attacks - the issue is table lookups that use secret information
as part of the address to lookup. A table lookup that is performed the exact same way every time
regardless of the key or plaintext doesn&#39;t leak any information. This implementation uses no data
dependant table lookups.

## Bit Slicing

Bit Slicing is a technique that is basically a software emulation of hardware implementation
techniques. One of the earliest implementations of this technique was for a DES implementation [4].
In hardware, table lookups do not present the same timing problems as they do in software, however
they present other problems - namely that a 256 byte S-box table takes up a huge amount of space on
a chip. Hardware implementations, thus, tend to avoid table lookups and instead calculate the
contents of the S-Boxes as part of every operation. So, the key to an efficient Bit Sliced software
implementation is to re-arrange all of the bits of data to process into a form that can easily be
applied in much the same way that it would be in hardeware. It is fortunate, that AES was designed
such that these types of hardware implementations could be very efficient - the contents of the
S-boxes are defined by a mathematical formula.

A hardware implementation works on single bits at a time. Unlike adding variables in software,
however, that occur generally one at a time, hardware implementations are extremely parallel and
operate on many, many bits at once. Bit Slicing emulates that by moving all &quot;equivalent&quot; bits into
common registers and then operating on large groups of bits all at once. Calculating the S-box value
for a single bit is extremely expensive, but its much cheaper when you can amortize that cost over
128 bits (as in an XMM register). This implementation follows the same strategy as in [5] and that
is an excellent source for more specific details. However, a short description follows.

The input data is simply a collection of bytes. Each byte is comprised of 8 bits, a low order bit
(bit 0) through a high order bit (bit 7). Bit slicing the input data simply takes all of the low
order bits (bit 0) from the input data, and moves them into a single register (eg: XMM0). Next, all
of them 2nd lowest bits are moved into their own register (eg: XMM1), and so on. After completion,
we&#39;re left with 8 variables, each of which contains an equivalent set of bits. The exact order of
those bits is irrevent for the implementation of the SubBytes step, however, it is very important
for the MixColumns step. Again, see [5] for details. Due to the design of AES, its them possible to
execute the entire AES operation using just bitwise exclusive ors and rotates once we have Bit
Sliced the input data. After the completion of the AES operation, we then un-Bit Slice the data
to give us our output. Clearly, the more bits that we can process at once, the faster this will go -
thus, the version that processes 8 blocks at once is roughly 8 times faster than processing just a
single block at a time.

The ShiftRows step is fairly straight-forward to implement on the Bit Sliced state. The MixColumns
and especially the SubBytes steps are more complicated. This implementation draws heavily on the
formulas from [5], [6], and [7] to implement these steps.

## Implementation

Both implementations work basically the same way and share pretty much all of their code. The key
is first processed to create all of the round keys where each round key is just a 16 byte chunk of
data that is combined into the AES state by the AddRoundKey step as part of each encryption or
decryption round. Processing the round key can be expensive, so this is done before encryption or
decryption. Before encrypting or decrypting data, the data to be processed by be Bit Sliced into 8
seperate variables where each variable holds equivalent bytes from the state. This Bit Sliced state
is stored as a Bs8State&lt;T&gt;, where T is the type that stores each set of bits. The first
implementation stores these bits in a u32 which permits up to 8 * 32 = 1024 bits of data to be
processed at once. This implementation only processes a single block at a time, so, in reality, only
512 bits are processed at once and the remaining 512 bits of the variables are unused. The 2nd
implementation uses u32x4s - vectors of 4 u32s. Thus, we can process 8 * 128 = 4096 bits at once,
which corresponds exactly to 8 blocks.

The Bs8State struct implements the AesOps trait, which contains methods for each of the 4 main steps
of the AES algorithm. The types, T, each implement the AesBitValueOps trait, which containts methods
necessary for processing a collection or bit values and the AesOps trait relies heavily on this
trait to perform its operations.

The Bs4State and Bs2State struct implement operations of various subfields of the full GF(2^8)
finite field which allows for efficient computation of the AES S-Boxes. See [7] for details.

## References

[1] - &quot;Cache-Collision Timing Attacks Against AES&quot;. Joseph Bonneau and Ilya Mironov.
      http://www.jbonneau.com/doc/BM06-CHES-aes_cache_timing.pdf
[2] - &quot;Software mitigations to hedge AES against cache-based software side channel vulnerabilities&quot;.
      Ernie Brickell, et al. http://eprint.iacr.org/2006/052.pdf.
[3] - &quot;Cache Attacks and Countermeasures: the Case of AES (Extended Version)&quot;.
      Dag Arne Osvik, et al. tau.ac.il/~tromer/papers/cache.pdf‎.
[4] - &quot;A Fast New DES Implementation in Software&quot;. Eli Biham.
      http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.52.5429&amp;rep=rep1&amp;type=pdf.
[5] - &quot;Faster and Timing-Attack Resistant AES-GCM&quot;. Emilia K ̈asper and Peter Schwabe.
      http://www.chesworkshop.org/ches2009/presentations/01_Session_1/CHES2009_ekasper.pdf.
[6] - &quot;FAST AES DECRYPTION&quot;. Vinit Azad. http://webcache.googleusercontent.com/
      search?q=cache:ld_f8pSgURcJ:csusdspace.calstate.edu/bitstream/handle/10211.9/1224/
      Vinit_Azad_MS_Report.doc%3Fsequence%3D2+&amp;cd=4&amp;hl=en&amp;ct=clnk&amp;gl=us&amp;client=ubuntu.
[7] - &quot;A Very Compact Rijndael S-box&quot;. D. Canright.
      http://www.dtic.mil/cgi-bin/GetTRDoc?AD=ADA434781.
*/

</span><span class="kw">use </span>std::ops::{BitAnd, BitXor, Not};
<span class="kw">use </span>std::default::Default;

<span class="kw">use </span>cryptoutil::{read_u32v_le, write_u32_le};
<span class="kw">use </span>simd::u32x4;
<span class="kw">use </span>step_by::RangeExt;
<span class="kw">use </span>symmetriccipher::{BlockEncryptor, BlockEncryptorX8, BlockDecryptor, BlockDecryptorX8};

<span class="kw">const </span>U32X4_0: u32x4 = u32x4(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);
<span class="kw">const </span>U32X4_1: u32x4 = u32x4(<span class="number">0xffffffff</span>, <span class="number">0xffffffff</span>, <span class="number">0xffffffff</span>, <span class="number">0xffffffff</span>);

<span class="macro">macro_rules! </span>define_aes_struct(
    (
        <span class="macro-nonterminal">$name</span>:ident,
        <span class="macro-nonterminal">$rounds</span>:expr
    ) =&gt; (
        <span class="attr">#[derive(Clone, Copy)]
        </span><span class="kw">pub struct </span><span class="macro-nonterminal">$name </span>{
            sk: [Bs8State&lt;u16&gt;; (<span class="macro-nonterminal">$rounds </span>+ <span class="number">1</span>)]
        }
    )
);

<span class="macro">macro_rules! </span>define_aes_impl(
    (
        <span class="macro-nonterminal">$name</span>:ident,
        <span class="macro-nonterminal">$mode</span>:ident,
        <span class="macro-nonterminal">$rounds</span>:expr,
        <span class="macro-nonterminal">$key_size</span>:expr
    ) =&gt; (
        <span class="kw">impl </span><span class="macro-nonterminal">$name </span>{
            <span class="kw">pub fn </span>new(key: <span class="kw-2">&amp;</span>[u8]) -&gt; <span class="macro-nonterminal">$name </span>{
                <span class="kw">let </span><span class="kw-2">mut </span>a =  <span class="macro-nonterminal">$name </span>{
                    sk: [Bs8State(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>); (<span class="macro-nonterminal">$rounds </span>+ <span class="number">1</span>)]
                };
                <span class="kw">let </span><span class="kw-2">mut </span>tmp = [[<span class="number">0u32</span>; <span class="number">4</span>]; (<span class="macro-nonterminal">$rounds </span>+ <span class="number">1</span>)];
                create_round_keys(key, KeyType::<span class="macro-nonterminal">$mode</span>, <span class="kw-2">&amp;mut </span>tmp);
                <span class="kw">for </span>i <span class="kw">in </span><span class="number">0</span>..<span class="macro-nonterminal">$rounds </span>+ <span class="number">1 </span>{
                    a.sk[i] = bit_slice_4x4_with_u16(tmp[i][<span class="number">0</span>], tmp[i][<span class="number">1</span>], tmp[i][<span class="number">2</span>], tmp[i][<span class="number">3</span>]);
                }
                a
            }
        }
    )
);

<span class="macro">macro_rules! </span>define_aes_enc(
    (
        <span class="macro-nonterminal">$name</span>:ident,
        <span class="macro-nonterminal">$rounds</span>:expr
    ) =&gt; (
        <span class="kw">impl </span>BlockEncryptor <span class="kw">for </span><span class="macro-nonterminal">$name </span>{
            <span class="kw">fn </span>block_size(<span class="kw-2">&amp;</span><span class="self">self</span>) -&gt; usize { <span class="number">16 </span>}
            <span class="kw">fn </span>encrypt_block(<span class="kw-2">&amp;</span><span class="self">self</span>, input: <span class="kw-2">&amp;</span>[u8], output: <span class="kw-2">&amp;mut </span>[u8]) {
                <span class="kw">let </span><span class="kw-2">mut </span>bs = bit_slice_1x16_with_u16(input);
                bs = encrypt_core(<span class="kw-2">&amp;</span>bs, <span class="kw-2">&amp;</span><span class="self">self</span>.sk);
                un_bit_slice_1x16_with_u16(<span class="kw-2">&amp;</span>bs, output);
            }
        }
    )
);

<span class="macro">macro_rules! </span>define_aes_dec(
    (
        <span class="macro-nonterminal">$name</span>:ident,
        <span class="macro-nonterminal">$rounds</span>:expr
    ) =&gt; (
        <span class="kw">impl </span>BlockDecryptor <span class="kw">for </span><span class="macro-nonterminal">$name </span>{
            <span class="kw">fn </span>block_size(<span class="kw-2">&amp;</span><span class="self">self</span>) -&gt; usize { <span class="number">16 </span>}
            <span class="kw">fn </span>decrypt_block(<span class="kw-2">&amp;</span><span class="self">self</span>, input: <span class="kw-2">&amp;</span>[u8], output: <span class="kw-2">&amp;mut </span>[u8]) {
                <span class="kw">let </span><span class="kw-2">mut </span>bs = bit_slice_1x16_with_u16(input);
                bs = decrypt_core(<span class="kw-2">&amp;</span>bs, <span class="kw-2">&amp;</span><span class="self">self</span>.sk);
                un_bit_slice_1x16_with_u16(<span class="kw-2">&amp;</span>bs, output);
            }
        }
    )
);

<span class="macro">define_aes_struct!</span>(AesSafe128Encryptor, <span class="number">10</span>);
<span class="macro">define_aes_struct!</span>(AesSafe128Decryptor, <span class="number">10</span>);
<span class="macro">define_aes_impl!</span>(AesSafe128Encryptor, Encryption, <span class="number">10</span>, <span class="number">16</span>);
<span class="macro">define_aes_impl!</span>(AesSafe128Decryptor, Decryption, <span class="number">10</span>, <span class="number">16</span>);
<span class="macro">define_aes_enc!</span>(AesSafe128Encryptor, <span class="number">10</span>);
<span class="macro">define_aes_dec!</span>(AesSafe128Decryptor, <span class="number">10</span>);

<span class="macro">define_aes_struct!</span>(AesSafe192Encryptor, <span class="number">12</span>);
<span class="macro">define_aes_struct!</span>(AesSafe192Decryptor, <span class="number">12</span>);
<span class="macro">define_aes_impl!</span>(AesSafe192Encryptor, Encryption, <span class="number">12</span>, <span class="number">24</span>);
<span class="macro">define_aes_impl!</span>(AesSafe192Decryptor, Decryption, <span class="number">12</span>, <span class="number">24</span>);
<span class="macro">define_aes_enc!</span>(AesSafe192Encryptor, <span class="number">12</span>);
<span class="macro">define_aes_dec!</span>(AesSafe192Decryptor, <span class="number">12</span>);

<span class="macro">define_aes_struct!</span>(AesSafe256Encryptor, <span class="number">14</span>);
<span class="macro">define_aes_struct!</span>(AesSafe256Decryptor, <span class="number">14</span>);
<span class="macro">define_aes_impl!</span>(AesSafe256Encryptor, Encryption, <span class="number">14</span>, <span class="number">32</span>);
<span class="macro">define_aes_impl!</span>(AesSafe256Decryptor, Decryption, <span class="number">14</span>, <span class="number">32</span>);
<span class="macro">define_aes_enc!</span>(AesSafe256Encryptor, <span class="number">14</span>);
<span class="macro">define_aes_dec!</span>(AesSafe256Decryptor, <span class="number">14</span>);

<span class="macro">macro_rules! </span>define_aes_struct_x8(
    (
        <span class="macro-nonterminal">$name</span>:ident,
        <span class="macro-nonterminal">$rounds</span>:expr
    ) =&gt; (
        <span class="attr">#[derive(Clone, Copy)]
        </span><span class="kw">pub struct </span><span class="macro-nonterminal">$name </span>{
            sk: [Bs8State&lt;u32x4&gt;; (<span class="macro-nonterminal">$rounds </span>+ <span class="number">1</span>)]
        }
    )
);

<span class="macro">macro_rules! </span>define_aes_impl_x8(
    (
        <span class="macro-nonterminal">$name</span>:ident,
        <span class="macro-nonterminal">$mode</span>:ident,
        <span class="macro-nonterminal">$rounds</span>:expr,
        <span class="macro-nonterminal">$key_size</span>:expr
    ) =&gt; (
        <span class="kw">impl </span><span class="macro-nonterminal">$name </span>{
            <span class="kw">pub fn </span>new(key: <span class="kw-2">&amp;</span>[u8]) -&gt; <span class="macro-nonterminal">$name </span>{
                <span class="kw">let </span><span class="kw-2">mut </span>a =  <span class="macro-nonterminal">$name </span>{
                    sk: [
                        Bs8State(
                            U32X4_0,
                            U32X4_0,
                            U32X4_0,
                            U32X4_0,
                            U32X4_0,
                            U32X4_0,
                            U32X4_0,
                            U32X4_0);
                        (<span class="macro-nonterminal">$rounds </span>+ <span class="number">1</span>)]
                };
                <span class="kw">let </span><span class="kw-2">mut </span>tmp = [[<span class="number">0u32</span>; <span class="number">4</span>]; (<span class="macro-nonterminal">$rounds </span>+ <span class="number">1</span>)];
                create_round_keys(key, KeyType::<span class="macro-nonterminal">$mode</span>, <span class="kw-2">&amp;mut </span>tmp);
                <span class="kw">for </span>i <span class="kw">in </span><span class="number">0</span>..<span class="macro-nonterminal">$rounds </span>+ <span class="number">1 </span>{
                    a.sk[i] = bit_slice_fill_4x4_with_u32x4(
                        tmp[i][<span class="number">0</span>],
                        tmp[i][<span class="number">1</span>],
                        tmp[i][<span class="number">2</span>],
                        tmp[i][<span class="number">3</span>]);
                }
                a
            }
        }
    )
);

<span class="macro">macro_rules! </span>define_aes_enc_x8(
    (
        <span class="macro-nonterminal">$name</span>:ident,
        <span class="macro-nonterminal">$rounds</span>:expr
    ) =&gt; (
        <span class="kw">impl </span>BlockEncryptorX8 <span class="kw">for </span><span class="macro-nonterminal">$name </span>{
            <span class="kw">fn </span>block_size(<span class="kw-2">&amp;</span><span class="self">self</span>) -&gt; usize { <span class="number">16 </span>}
            <span class="kw">fn </span>encrypt_block_x8(<span class="kw-2">&amp;</span><span class="self">self</span>, input: <span class="kw-2">&amp;</span>[u8], output: <span class="kw-2">&amp;mut </span>[u8]) {
                <span class="kw">let </span>bs = bit_slice_1x128_with_u32x4(input);
                <span class="kw">let </span>bs2 = encrypt_core(<span class="kw-2">&amp;</span>bs, <span class="kw-2">&amp;</span><span class="self">self</span>.sk);
                un_bit_slice_1x128_with_u32x4(bs2, output);
            }
        }
    )
);

<span class="macro">macro_rules! </span>define_aes_dec_x8(
    (
        <span class="macro-nonterminal">$name</span>:ident,
        <span class="macro-nonterminal">$rounds</span>:expr
    ) =&gt; (
        <span class="kw">impl </span>BlockDecryptorX8 <span class="kw">for </span><span class="macro-nonterminal">$name </span>{
            <span class="kw">fn </span>block_size(<span class="kw-2">&amp;</span><span class="self">self</span>) -&gt; usize { <span class="number">16 </span>}
            <span class="kw">fn </span>decrypt_block_x8(<span class="kw-2">&amp;</span><span class="self">self</span>, input: <span class="kw-2">&amp;</span>[u8], output: <span class="kw-2">&amp;mut </span>[u8]) {
                <span class="kw">let </span>bs = bit_slice_1x128_with_u32x4(input);
                <span class="kw">let </span>bs2 = decrypt_core(<span class="kw-2">&amp;</span>bs, <span class="kw-2">&amp;</span><span class="self">self</span>.sk);
                un_bit_slice_1x128_with_u32x4(bs2, output);
            }
        }
    )
);

<span class="macro">define_aes_struct_x8!</span>(AesSafe128EncryptorX8, <span class="number">10</span>);
<span class="macro">define_aes_struct_x8!</span>(AesSafe128DecryptorX8, <span class="number">10</span>);
<span class="macro">define_aes_impl_x8!</span>(AesSafe128EncryptorX8, Encryption, <span class="number">10</span>, <span class="number">16</span>);
<span class="macro">define_aes_impl_x8!</span>(AesSafe128DecryptorX8, Decryption, <span class="number">10</span>, <span class="number">16</span>);
<span class="macro">define_aes_enc_x8!</span>(AesSafe128EncryptorX8, <span class="number">10</span>);
<span class="macro">define_aes_dec_x8!</span>(AesSafe128DecryptorX8, <span class="number">10</span>);

<span class="macro">define_aes_struct_x8!</span>(AesSafe192EncryptorX8, <span class="number">12</span>);
<span class="macro">define_aes_struct_x8!</span>(AesSafe192DecryptorX8, <span class="number">12</span>);
<span class="macro">define_aes_impl_x8!</span>(AesSafe192EncryptorX8, Encryption, <span class="number">12</span>, <span class="number">24</span>);
<span class="macro">define_aes_impl_x8!</span>(AesSafe192DecryptorX8, Decryption, <span class="number">12</span>, <span class="number">24</span>);
<span class="macro">define_aes_enc_x8!</span>(AesSafe192EncryptorX8, <span class="number">12</span>);
<span class="macro">define_aes_dec_x8!</span>(AesSafe192DecryptorX8, <span class="number">12</span>);

<span class="macro">define_aes_struct_x8!</span>(AesSafe256EncryptorX8, <span class="number">14</span>);
<span class="macro">define_aes_struct_x8!</span>(AesSafe256DecryptorX8, <span class="number">14</span>);
<span class="macro">define_aes_impl_x8!</span>(AesSafe256EncryptorX8, Encryption, <span class="number">14</span>, <span class="number">32</span>);
<span class="macro">define_aes_impl_x8!</span>(AesSafe256DecryptorX8, Decryption, <span class="number">14</span>, <span class="number">32</span>);
<span class="macro">define_aes_enc_x8!</span>(AesSafe256EncryptorX8, <span class="number">14</span>);
<span class="macro">define_aes_dec_x8!</span>(AesSafe256DecryptorX8, <span class="number">14</span>);

<span class="kw">fn </span>ffmulx(x: u32) -&gt; u32 {
    <span class="kw">let </span>m1: u32 = <span class="number">0x80808080</span>;
    <span class="kw">let </span>m2: u32 = <span class="number">0x7f7f7f7f</span>;
    <span class="kw">let </span>m3: u32 = <span class="number">0x0000001b</span>;
    ((x &amp; m2) &lt;&lt; <span class="number">1</span>) ^ (((x &amp; m1) &gt;&gt; <span class="number">7</span>) * m3)
}

<span class="kw">fn </span>inv_mcol(x: u32) -&gt; u32 {
    <span class="kw">let </span>f2 = ffmulx(x);
    <span class="kw">let </span>f4 = ffmulx(f2);
    <span class="kw">let </span>f8 = ffmulx(f4);
    <span class="kw">let </span>f9 = x ^ f8;

    f2 ^ f4 ^ f8 ^ (f2 ^ f9).rotate_right(<span class="number">8</span>) ^ (f4 ^ f9).rotate_right(<span class="number">16</span>) ^ f9.rotate_right(<span class="number">24</span>)
}

<span class="kw">fn </span>sub_word(x: u32) -&gt; u32 {
    <span class="kw">let </span>bs = bit_slice_4x1_with_u16(x).sub_bytes();
    un_bit_slice_4x1_with_u16(<span class="kw-2">&amp;</span>bs)
}

<span class="kw">enum </span>KeyType {
    Encryption,
    Decryption
}

<span class="comment">// This array is not accessed in any key-dependant way, so there are no timing problems inherent in
// using it.
</span><span class="kw">static </span>RCON: [u32; <span class="number">10</span>] = [<span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x10</span>, <span class="number">0x20</span>, <span class="number">0x40</span>, <span class="number">0x80</span>, <span class="number">0x1b</span>, <span class="number">0x36</span>];

<span class="comment">// The round keys are created without bit-slicing the key data. The individual implementations bit
// slice the round keys returned from this function. This function, and the few functions above, are
// derived from the BouncyCastle AES implementation.
</span><span class="kw">fn </span>create_round_keys(key: <span class="kw-2">&amp;</span>[u8], key_type: KeyType, round_keys: <span class="kw-2">&amp;mut </span>[[u32; <span class="number">4</span>]]) {
    <span class="kw">let </span>(key_words, rounds) = <span class="kw">match </span>key.len() {
        <span class="number">16 </span>=&gt; (<span class="number">4</span>, <span class="number">10</span>),
        <span class="number">24 </span>=&gt; (<span class="number">6</span>, <span class="number">12</span>),
        <span class="number">32 </span>=&gt; (<span class="number">8</span>, <span class="number">14</span>),
        <span class="kw">_ </span>=&gt; <span class="macro">panic!</span>(<span class="string">&quot;Invalid AES key size.&quot;</span>)
    };

    <span class="comment">// The key is copied directly into the first few round keys
    </span><span class="kw">let </span><span class="kw-2">mut </span>j = <span class="number">0</span>;
    <span class="kw">for </span>i <span class="kw">in </span>(<span class="number">0</span>..key.len()).step_up(<span class="number">4</span>) {
        round_keys[j / <span class="number">4</span>][j % <span class="number">4</span>] =
            (key[i] <span class="kw">as </span>u32) |
            ((key[i+<span class="number">1</span>] <span class="kw">as </span>u32) &lt;&lt; <span class="number">8</span>) |
            ((key[i+<span class="number">2</span>] <span class="kw">as </span>u32) &lt;&lt; <span class="number">16</span>) |
            ((key[i+<span class="number">3</span>] <span class="kw">as </span>u32) &lt;&lt; <span class="number">24</span>);
        j += <span class="number">1</span>;
    };

    <span class="comment">// Calculate the rest of the round keys
    </span><span class="kw">for </span>i <span class="kw">in </span>key_words..(rounds + <span class="number">1</span>) * <span class="number">4 </span>{
        <span class="kw">let </span><span class="kw-2">mut </span>tmp = round_keys[(i - <span class="number">1</span>) / <span class="number">4</span>][(i - <span class="number">1</span>) % <span class="number">4</span>];
        <span class="kw">if </span>(i % key_words) == <span class="number">0 </span>{
            tmp = sub_word(tmp.rotate_right(<span class="number">8</span>)) ^ RCON[(i / key_words) - <span class="number">1</span>];
        } <span class="kw">else if </span>(key_words == <span class="number">8</span>) &amp;&amp; ((i % key_words) == <span class="number">4</span>) {
            <span class="comment">// This is only necessary for AES-256 keys
            </span>tmp = sub_word(tmp);
        }
        round_keys[i / <span class="number">4</span>][i % <span class="number">4</span>] = round_keys[(i - key_words) / <span class="number">4</span>][(i - key_words) % <span class="number">4</span>] ^ tmp;
    }

    <span class="comment">// Decryption round keys require extra processing
    </span><span class="kw">match </span>key_type {
        KeyType::Decryption =&gt; {
            <span class="kw">for </span>j <span class="kw">in </span><span class="number">1</span>..rounds {
                <span class="kw">for </span>i <span class="kw">in </span><span class="number">0</span>..<span class="number">4 </span>{
                    round_keys[j][i] = inv_mcol(round_keys[j][i]);
                }
            }
        },
        KeyType::Encryption =&gt; { }
    }
}

<span class="comment">// This trait defines all of the operations needed for a type to be processed as part of an AES
// encryption or decryption operation.
</span><span class="kw">trait </span>AesOps {
    <span class="kw">fn </span>sub_bytes(<span class="self">self</span>) -&gt; <span class="self">Self</span>;
    <span class="kw">fn </span>inv_sub_bytes(<span class="self">self</span>) -&gt; <span class="self">Self</span>;
    <span class="kw">fn </span>shift_rows(<span class="self">self</span>) -&gt; <span class="self">Self</span>;
    <span class="kw">fn </span>inv_shift_rows(<span class="self">self</span>) -&gt; <span class="self">Self</span>;
    <span class="kw">fn </span>mix_columns(<span class="self">self</span>) -&gt; <span class="self">Self</span>;
    <span class="kw">fn </span>inv_mix_columns(<span class="self">self</span>) -&gt; <span class="self">Self</span>;
    <span class="kw">fn </span>add_round_key(<span class="self">self</span>, rk: <span class="kw-2">&amp;</span><span class="self">Self</span>) -&gt; <span class="self">Self</span>;
}

<span class="kw">fn </span>encrypt_core&lt;S: AesOps + Copy&gt;(state: <span class="kw-2">&amp;</span>S, sk: <span class="kw-2">&amp;</span>[S]) -&gt; S {
    <span class="comment">// Round 0 - add round key
    </span><span class="kw">let </span><span class="kw-2">mut </span>tmp = state.add_round_key(<span class="kw-2">&amp;</span>sk[<span class="number">0</span>]);

    <span class="comment">// Remaining rounds (except last round)
    </span><span class="kw">for </span>i <span class="kw">in </span><span class="number">1</span>..sk.len() - <span class="number">1 </span>{
        tmp = tmp.sub_bytes();
        tmp = tmp.shift_rows();
        tmp = tmp.mix_columns();
        tmp = tmp.add_round_key(<span class="kw-2">&amp;</span>sk[i]);
    }

    <span class="comment">// Last round
    </span>tmp = tmp.sub_bytes();
    tmp = tmp.shift_rows();
    tmp = tmp.add_round_key(<span class="kw-2">&amp;</span>sk[sk.len() - <span class="number">1</span>]);

    tmp
}

<span class="kw">fn </span>decrypt_core&lt;S: AesOps + Copy&gt;(state: <span class="kw-2">&amp;</span>S, sk: <span class="kw-2">&amp;</span>[S]) -&gt; S {
    <span class="comment">// Round 0 - add round key
    </span><span class="kw">let </span><span class="kw-2">mut </span>tmp = state.add_round_key(<span class="kw-2">&amp;</span>sk[sk.len() - <span class="number">1</span>]);

    <span class="comment">// Remaining rounds (except last round)
    </span><span class="kw">for </span>i <span class="kw">in </span><span class="number">1</span>..sk.len() - <span class="number">1 </span>{
        tmp = tmp.inv_sub_bytes();
        tmp = tmp.inv_shift_rows();
        tmp = tmp.inv_mix_columns();
        tmp = tmp.add_round_key(<span class="kw-2">&amp;</span>sk[sk.len() - <span class="number">1 </span>- i]);
    }

    <span class="comment">// Last round
    </span>tmp = tmp.inv_sub_bytes();
    tmp = tmp.inv_shift_rows();
    tmp = tmp.add_round_key(<span class="kw-2">&amp;</span>sk[<span class="number">0</span>]);

    tmp
}

<span class="attr">#[derive(Clone, Copy)]
</span><span class="kw">struct </span>Bs8State&lt;T&gt;(T, T, T, T, T, T, T, T);

<span class="kw">impl </span>&lt;T: Copy&gt; Bs8State&lt;T&gt; {
    <span class="kw">fn </span>split(<span class="self">self</span>) -&gt; (Bs4State&lt;T&gt;, Bs4State&lt;T&gt;) {
        <span class="kw">let </span>Bs8State(x0, x1, x2, x3, x4, x5, x6, x7) = <span class="self">self</span>;
        (Bs4State(x0, x1, x2, x3), Bs4State(x4, x5, x6, x7))
    }
}

<span class="kw">impl </span>&lt;T: BitXor&lt;Output = T&gt; + Copy&gt; Bs8State&lt;T&gt; {
    <span class="kw">fn </span>xor(<span class="self">self</span>, rhs: Bs8State&lt;T&gt;) -&gt; Bs8State&lt;T&gt; {
        <span class="kw">let </span>Bs8State(a0, a1, a2, a3, a4, a5, a6, a7) = <span class="self">self</span>;
        <span class="kw">let </span>Bs8State(b0, b1, b2, b3, b4, b5, b6, b7) = rhs;
        Bs8State(a0 ^ b0, a1 ^ b1, a2 ^ b2, a3 ^ b3, a4 ^ b4, a5 ^ b5, a6 ^ b6, a7 ^ b7)
    }

    <span class="comment">// We need to be able to convert a Bs8State to and from a polynomial basis and a normal
    // basis. That transformation could be done via pseudocode that roughly looks like the
    // following:
    //
    // for x in 0..8 {
    //     for y in 0..8 {
    //         result.x ^= input.y &amp; MATRIX[7 - y][x]
    //     }
    // }
    //
    // Where the MATRIX is one of the following depending on the conversion being done.
    // (The affine transformation step is included in all of these matrices):
    //
    // A2X = [
    //     [ 0,  0,  0, -1, -1,  0,  0, -1],
    //     [-1, -1,  0,  0, -1, -1, -1, -1],
    //     [ 0, -1,  0,  0, -1, -1, -1, -1],
    //     [ 0,  0,  0, -1,  0,  0, -1,  0],
    //     [-1,  0,  0, -1,  0,  0,  0,  0],
    //     [-1,  0,  0,  0,  0,  0,  0, -1],
    //     [-1,  0,  0, -1,  0, -1,  0, -1],
    //     [-1, -1, -1, -1, -1, -1, -1, -1]
    // ];
    //
    // X2A = [
    //     [ 0,  0, -1,  0,  0, -1, -1,  0],
    //     [ 0,  0,  0, -1, -1, -1, -1,  0],
    //     [ 0, -1, -1, -1,  0, -1, -1,  0],
    //     [ 0,  0, -1, -1,  0,  0,  0, -1],
    //     [ 0,  0,  0, -1,  0, -1, -1,  0],
    //     [-1,  0,  0, -1,  0, -1,  0,  0],
    //     [ 0, -1, -1, -1, -1,  0, -1, -1],
    //     [ 0,  0,  0,  0,  0, -1, -1,  0],
    // ];
    //
    // X2S = [
    //     [ 0,  0,  0, -1, -1,  0, -1,  0],
    //     [-1,  0, -1, -1,  0, -1,  0,  0],
    //     [ 0, -1, -1, -1, -1,  0,  0, -1],
    //     [-1, -1,  0, -1,  0,  0,  0,  0],
    //     [ 0,  0, -1, -1, -1,  0, -1, -1],
    //     [ 0,  0, -1,  0,  0,  0,  0,  0],
    //     [-1, -1,  0,  0,  0,  0,  0,  0],
    //     [ 0,  0, -1,  0,  0, -1,  0,  0],
    // ];
    //
    // S2X = [
    //     [ 0,  0, -1, -1,  0,  0,  0, -1],
    //     [-1,  0,  0, -1, -1, -1, -1,  0],
    //     [-1,  0, -1,  0,  0,  0,  0,  0],
    //     [-1, -1,  0, -1,  0, -1, -1, -1],
    //     [ 0, -1,  0,  0, -1,  0,  0,  0],
    //     [ 0,  0, -1,  0,  0,  0,  0,  0],
    //     [-1,  0,  0,  0, -1,  0, -1,  0],
    //     [-1, -1,  0,  0, -1,  0, -1,  0],
    // ];
    //
    // Looking at the pseudocode implementation, we see that there is no point
    // in processing any of the elements in those matrices that have zero values
    // since a logical AND with 0 will produce 0 which will have no effect when it
    // is XORed into the result.
    //
    // LLVM doesn&#39;t appear to be able to fully unroll the loops in the pseudocode
    // above and to eliminate processing of the 0 elements. So, each transformation is
    // implemented independently directly in fully unrolled form with the 0 elements
    // removed.
    //
    // As an optimization, elements that are XORed together multiple times are
    // XORed just once and then used multiple times. I wrote a simple program that
    // greedily looked for terms to combine to create the implementations below.
    // It is likely that this could be optimized more.

    </span><span class="kw">fn </span>change_basis_a2x(<span class="kw-2">&amp;</span><span class="self">self</span>) -&gt; Bs8State&lt;T&gt; {
        <span class="kw">let </span>t06 = <span class="self">self</span>.<span class="number">6 </span>^ <span class="self">self</span>.<span class="number">0</span>;
        <span class="kw">let </span>t056 = <span class="self">self</span>.<span class="number">5 </span>^ t06;
        <span class="kw">let </span>t0156 = t056 ^ <span class="self">self</span>.<span class="number">1</span>;
        <span class="kw">let </span>t13 = <span class="self">self</span>.<span class="number">1 </span>^ <span class="self">self</span>.<span class="number">3</span>;

        <span class="kw">let </span>x0 = <span class="self">self</span>.<span class="number">2 </span>^ t06 ^ t13;
        <span class="kw">let </span>x1 = t056;
        <span class="kw">let </span>x2 = <span class="self">self</span>.<span class="number">0</span>;
        <span class="kw">let </span>x3 = <span class="self">self</span>.<span class="number">0 </span>^ <span class="self">self</span>.<span class="number">4 </span>^ <span class="self">self</span>.<span class="number">7 </span>^ t13;
        <span class="kw">let </span>x4 = <span class="self">self</span>.<span class="number">7 </span>^ t056;
        <span class="kw">let </span>x5 = t0156;
        <span class="kw">let </span>x6 = <span class="self">self</span>.<span class="number">4 </span>^ t056;
        <span class="kw">let </span>x7 = <span class="self">self</span>.<span class="number">2 </span>^ <span class="self">self</span>.<span class="number">7 </span>^ t0156;

        Bs8State(x0, x1, x2, x3, x4, x5, x6, x7)
    }

    <span class="kw">fn </span>change_basis_x2s(<span class="kw-2">&amp;</span><span class="self">self</span>) -&gt; Bs8State&lt;T&gt; {
        <span class="kw">let </span>t46 = <span class="self">self</span>.<span class="number">4 </span>^ <span class="self">self</span>.<span class="number">6</span>;
        <span class="kw">let </span>t35 = <span class="self">self</span>.<span class="number">3 </span>^ <span class="self">self</span>.<span class="number">5</span>;
        <span class="kw">let </span>t06 = <span class="self">self</span>.<span class="number">0 </span>^ <span class="self">self</span>.<span class="number">6</span>;
        <span class="kw">let </span>t357 = t35 ^ <span class="self">self</span>.<span class="number">7</span>;

        <span class="kw">let </span>x0 = <span class="self">self</span>.<span class="number">1 </span>^ t46;
        <span class="kw">let </span>x1 = <span class="self">self</span>.<span class="number">1 </span>^ <span class="self">self</span>.<span class="number">4 </span>^ <span class="self">self</span>.<span class="number">5</span>;
        <span class="kw">let </span>x2 = <span class="self">self</span>.<span class="number">2 </span>^ t35 ^ t06;
        <span class="kw">let </span>x3 = t46 ^ t357;
        <span class="kw">let </span>x4 = t357;
        <span class="kw">let </span>x5 = t06;
        <span class="kw">let </span>x6 = <span class="self">self</span>.<span class="number">3 </span>^ <span class="self">self</span>.<span class="number">7</span>;
        <span class="kw">let </span>x7 = t35;

        Bs8State(x0, x1, x2, x3, x4, x5, x6, x7)
    }

    <span class="kw">fn </span>change_basis_x2a(<span class="kw-2">&amp;</span><span class="self">self</span>) -&gt; Bs8State&lt;T&gt; {
        <span class="kw">let </span>t15 = <span class="self">self</span>.<span class="number">1 </span>^ <span class="self">self</span>.<span class="number">5</span>;
        <span class="kw">let </span>t36 = <span class="self">self</span>.<span class="number">3 </span>^ <span class="self">self</span>.<span class="number">6</span>;
        <span class="kw">let </span>t1356 = t15 ^ t36;
        <span class="kw">let </span>t07 = <span class="self">self</span>.<span class="number">0 </span>^ <span class="self">self</span>.<span class="number">7</span>;

        <span class="kw">let </span>x0 = <span class="self">self</span>.<span class="number">2</span>;
        <span class="kw">let </span>x1 = t15;
        <span class="kw">let </span>x2 = <span class="self">self</span>.<span class="number">4 </span>^ <span class="self">self</span>.<span class="number">7 </span>^ t15;
        <span class="kw">let </span>x3 = <span class="self">self</span>.<span class="number">2 </span>^ <span class="self">self</span>.<span class="number">4 </span>^ t1356;
        <span class="kw">let </span>x4 = <span class="self">self</span>.<span class="number">1 </span>^ <span class="self">self</span>.<span class="number">6</span>;
        <span class="kw">let </span>x5 = <span class="self">self</span>.<span class="number">2 </span>^ <span class="self">self</span>.<span class="number">5 </span>^ t36 ^ t07;
        <span class="kw">let </span>x6 = t1356 ^ t07;
        <span class="kw">let </span>x7 = <span class="self">self</span>.<span class="number">1 </span>^ <span class="self">self</span>.<span class="number">4</span>;

        Bs8State(x0, x1, x2, x3, x4, x5, x6, x7)
    }

    <span class="kw">fn </span>change_basis_s2x(<span class="kw-2">&amp;</span><span class="self">self</span>) -&gt; Bs8State&lt;T&gt; {
        <span class="kw">let </span>t46 = <span class="self">self</span>.<span class="number">4 </span>^ <span class="self">self</span>.<span class="number">6</span>;
        <span class="kw">let </span>t01 = <span class="self">self</span>.<span class="number">0 </span>^ <span class="self">self</span>.<span class="number">1</span>;
        <span class="kw">let </span>t0146 = t01 ^ t46;

        <span class="kw">let </span>x0 = <span class="self">self</span>.<span class="number">5 </span>^ t0146;
        <span class="kw">let </span>x1 = <span class="self">self</span>.<span class="number">0 </span>^ <span class="self">self</span>.<span class="number">3 </span>^ <span class="self">self</span>.<span class="number">4</span>;
        <span class="kw">let </span>x2 = <span class="self">self</span>.<span class="number">2 </span>^ <span class="self">self</span>.<span class="number">5 </span>^ <span class="self">self</span>.<span class="number">7</span>;
        <span class="kw">let </span>x3 = <span class="self">self</span>.<span class="number">7 </span>^ t46;
        <span class="kw">let </span>x4 = <span class="self">self</span>.<span class="number">3 </span>^ <span class="self">self</span>.<span class="number">6 </span>^ t01;
        <span class="kw">let </span>x5 = t46;
        <span class="kw">let </span>x6 = t0146;
        <span class="kw">let </span>x7 = <span class="self">self</span>.<span class="number">4 </span>^ <span class="self">self</span>.<span class="number">7</span>;

        Bs8State(x0, x1, x2, x3, x4, x5, x6, x7)
    }
}

<span class="kw">impl </span>&lt;T: Not&lt;Output = T&gt; + Copy&gt; Bs8State&lt;T&gt; {
    <span class="comment">// The special value &quot;x63&quot; is used as part of the sub_bytes and inv_sub_bytes
    // steps. It is conceptually a Bs8State value where the 0th, 1st, 5th, and 6th
    // elements are all 1s and the other elements are all 0s. The only thing that
    // we do with the &quot;x63&quot; value is to XOR a Bs8State with it. We optimize that XOR
    // below into just inverting 4 of the elements and leaving the other 4 elements
    // untouched.
    </span><span class="kw">fn </span>xor_x63(<span class="self">self</span>) -&gt; Bs8State&lt;T&gt; {
        Bs8State (
            !<span class="self">self</span>.<span class="number">0</span>,
            !<span class="self">self</span>.<span class="number">1</span>,
            <span class="self">self</span>.<span class="number">2</span>,
            <span class="self">self</span>.<span class="number">3</span>,
            <span class="self">self</span>.<span class="number">4</span>,
            !<span class="self">self</span>.<span class="number">5</span>,
            !<span class="self">self</span>.<span class="number">6</span>,
            <span class="self">self</span>.<span class="number">7</span>)
    }
}

<span class="attr">#[derive(Clone, Copy)]
</span><span class="kw">struct </span>Bs4State&lt;T&gt;(T, T, T, T);

<span class="kw">impl </span>&lt;T: Copy&gt; Bs4State&lt;T&gt; {
    <span class="kw">fn </span>split(<span class="self">self</span>) -&gt; (Bs2State&lt;T&gt;, Bs2State&lt;T&gt;) {
        <span class="kw">let </span>Bs4State(x0, x1, x2, x3) = <span class="self">self</span>;
        (Bs2State(x0, x1), Bs2State(x2, x3))
    }

    <span class="kw">fn </span>join(<span class="self">self</span>, rhs: Bs4State&lt;T&gt;) -&gt; Bs8State&lt;T&gt; {
        <span class="kw">let </span>Bs4State(a0, a1, a2, a3) = <span class="self">self</span>;
        <span class="kw">let </span>Bs4State(b0, b1, b2, b3) = rhs;
        Bs8State(a0, a1, a2, a3, b0, b1, b2, b3)
    }
}

<span class="kw">impl </span>&lt;T: BitXor&lt;Output = T&gt; + Copy&gt; Bs4State&lt;T&gt; {
    <span class="kw">fn </span>xor(<span class="self">self</span>, rhs: Bs4State&lt;T&gt;) -&gt; Bs4State&lt;T&gt; {
        <span class="kw">let </span>Bs4State(a0, a1, a2, a3) = <span class="self">self</span>;
        <span class="kw">let </span>Bs4State(b0, b1, b2, b3) = rhs;
        Bs4State(a0 ^ b0, a1 ^ b1, a2 ^ b2, a3 ^ b3)
    }
}

<span class="attr">#[derive(Clone, Copy)]
</span><span class="kw">struct </span>Bs2State&lt;T&gt;(T, T);

<span class="kw">impl </span>&lt;T&gt; Bs2State&lt;T&gt; {
    <span class="kw">fn </span>split(<span class="self">self</span>) -&gt; (T, T) {
        <span class="kw">let </span>Bs2State(x0, x1) = <span class="self">self</span>;
        (x0, x1)
    }

    <span class="kw">fn </span>join(<span class="self">self</span>, rhs: Bs2State&lt;T&gt;) -&gt; Bs4State&lt;T&gt; {
        <span class="kw">let </span>Bs2State(a0, a1) = <span class="self">self</span>;
        <span class="kw">let </span>Bs2State(b0, b1) = rhs;
        Bs4State(a0, a1, b0, b1)
    }
}

<span class="kw">impl </span>&lt;T: BitXor&lt;Output = T&gt; + Copy&gt; Bs2State&lt;T&gt; {
    <span class="kw">fn </span>xor(<span class="self">self</span>, rhs: Bs2State&lt;T&gt;) -&gt; Bs2State&lt;T&gt; {
        <span class="kw">let </span>Bs2State(a0, a1) = <span class="self">self</span>;
        <span class="kw">let </span>Bs2State(b0, b1) = rhs;
        Bs2State(a0 ^ b0, a1 ^ b1)
    }
}

<span class="comment">// Bit Slice data in the form of 4 u32s in column-major order
</span><span class="kw">fn </span>bit_slice_4x4_with_u16(a: u32, b: u32, c: u32, d: u32) -&gt; Bs8State&lt;u16&gt; {
    <span class="kw">fn </span>pb(x: u32, bit: u32, shift: u32) -&gt; u16 {
        (((x &gt;&gt; bit) &amp; <span class="number">1</span>) <span class="kw">as </span>u16) &lt;&lt; shift
    }

    <span class="kw">fn </span>construct(a: u32, b: u32, c: u32, d: u32, bit: u32) -&gt; u16 {
        pb(a, bit, <span class="number">0</span>)       | pb(b, bit, <span class="number">1</span>)       | pb(c, bit, <span class="number">2</span>)       | pb(d, bit, <span class="number">3</span>)       |
        pb(a, bit + <span class="number">8</span>, <span class="number">4</span>)   | pb(b, bit + <span class="number">8</span>, <span class="number">5</span>)   | pb(c, bit + <span class="number">8</span>, <span class="number">6</span>)   | pb(d, bit + <span class="number">8</span>, <span class="number">7</span>)   |
        pb(a, bit + <span class="number">16</span>, <span class="number">8</span>)  | pb(b, bit + <span class="number">16</span>, <span class="number">9</span>)  | pb(c, bit + <span class="number">16</span>, <span class="number">10</span>) | pb(d, bit + <span class="number">16</span>, <span class="number">11</span>) |
        pb(a, bit + <span class="number">24</span>, <span class="number">12</span>) | pb(b, bit + <span class="number">24</span>, <span class="number">13</span>) | pb(c, bit + <span class="number">24</span>, <span class="number">14</span>) | pb(d, bit + <span class="number">24</span>, <span class="number">15</span>)
    }

    <span class="kw">let </span>x0 = construct(a, b, c, d, <span class="number">0</span>);
    <span class="kw">let </span>x1 = construct(a, b, c, d, <span class="number">1</span>);
    <span class="kw">let </span>x2 = construct(a, b, c, d, <span class="number">2</span>);
    <span class="kw">let </span>x3 = construct(a, b, c, d, <span class="number">3</span>);
    <span class="kw">let </span>x4 = construct(a, b, c, d, <span class="number">4</span>);
    <span class="kw">let </span>x5 = construct(a, b, c, d, <span class="number">5</span>);
    <span class="kw">let </span>x6 = construct(a, b, c, d, <span class="number">6</span>);
    <span class="kw">let </span>x7 = construct(a, b, c, d, <span class="number">7</span>);

    Bs8State(x0, x1, x2, x3, x4, x5, x6, x7)
}

<span class="comment">// Bit slice a single u32 value - this is used to calculate the SubBytes step when creating the
// round keys.
</span><span class="kw">fn </span>bit_slice_4x1_with_u16(a: u32) -&gt; Bs8State&lt;u16&gt; {
    bit_slice_4x4_with_u16(a, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)
}

<span class="comment">// Bit slice a 16 byte array in column major order
</span><span class="kw">fn </span>bit_slice_1x16_with_u16(data: <span class="kw-2">&amp;</span>[u8]) -&gt; Bs8State&lt;u16&gt; {
    <span class="kw">let </span><span class="kw-2">mut </span>n = [<span class="number">0u32</span>; <span class="number">4</span>];
    read_u32v_le(<span class="kw-2">&amp;mut </span>n, data);

    <span class="kw">let </span>a = n[<span class="number">0</span>];
    <span class="kw">let </span>b = n[<span class="number">1</span>];
    <span class="kw">let </span>c = n[<span class="number">2</span>];
    <span class="kw">let </span>d = n[<span class="number">3</span>];

    bit_slice_4x4_with_u16(a, b, c, d)
}

<span class="comment">// Un Bit Slice into a set of 4 u32s
</span><span class="kw">fn </span>un_bit_slice_4x4_with_u16(bs: <span class="kw-2">&amp;</span>Bs8State&lt;u16&gt;) -&gt; (u32, u32, u32, u32) {
    <span class="kw">fn </span>pb(x: u16, bit: u32, shift: u32) -&gt; u32 {
        (((x &gt;&gt; bit) &amp; <span class="number">1</span>) <span class="kw">as </span>u32) &lt;&lt; shift
    }

    <span class="kw">fn </span>deconstruct(bs: <span class="kw-2">&amp;</span>Bs8State&lt;u16&gt;, bit: u32) -&gt; u32 {
        <span class="kw">let </span>Bs8State(x0, x1, x2, x3, x4, x5, x6, x7) = <span class="kw-2">*</span>bs;

        pb(x0, bit, <span class="number">0</span>) | pb(x1, bit, <span class="number">1</span>) | pb(x2, bit, <span class="number">2</span>) | pb(x3, bit, <span class="number">3</span>) |
        pb(x4, bit, <span class="number">4</span>) | pb(x5, bit, <span class="number">5</span>) | pb(x6, bit, <span class="number">6</span>) | pb(x7, bit, <span class="number">7</span>) |

        pb(x0, bit + <span class="number">4</span>, <span class="number">8</span>)  | pb(x1, bit + <span class="number">4</span>, <span class="number">9</span>)  | pb(x2, bit + <span class="number">4</span>, <span class="number">10</span>) | pb(x3, bit + <span class="number">4</span>, <span class="number">11</span>) |
        pb(x4, bit + <span class="number">4</span>, <span class="number">12</span>) | pb(x5, bit + <span class="number">4</span>, <span class="number">13</span>) | pb(x6, bit + <span class="number">4</span>, <span class="number">14</span>) | pb(x7, bit + <span class="number">4</span>, <span class="number">15</span>) |

        pb(x0, bit + <span class="number">8</span>, <span class="number">16</span>) | pb(x1, bit + <span class="number">8</span>, <span class="number">17</span>) | pb(x2, bit + <span class="number">8</span>, <span class="number">18</span>) | pb(x3, bit + <span class="number">8</span>, <span class="number">19</span>) |
        pb(x4, bit + <span class="number">8</span>, <span class="number">20</span>) | pb(x5, bit + <span class="number">8</span>, <span class="number">21</span>) | pb(x6, bit + <span class="number">8</span>, <span class="number">22</span>) | pb(x7, bit + <span class="number">8</span>, <span class="number">23</span>) |

        pb(x0, bit + <span class="number">12</span>, <span class="number">24</span>) | pb(x1, bit + <span class="number">12</span>, <span class="number">25</span>) | pb(x2, bit + <span class="number">12</span>, <span class="number">26</span>) | pb(x3, bit + <span class="number">12</span>, <span class="number">27</span>) |
        pb(x4, bit + <span class="number">12</span>, <span class="number">28</span>) | pb(x5, bit + <span class="number">12</span>, <span class="number">29</span>) | pb(x6, bit + <span class="number">12</span>, <span class="number">30</span>) | pb(x7, bit + <span class="number">12</span>, <span class="number">31</span>)
    }

    <span class="kw">let </span>a = deconstruct(bs, <span class="number">0</span>);
    <span class="kw">let </span>b = deconstruct(bs, <span class="number">1</span>);
    <span class="kw">let </span>c = deconstruct(bs, <span class="number">2</span>);
    <span class="kw">let </span>d = deconstruct(bs, <span class="number">3</span>);

    (a, b, c, d)
}

<span class="comment">// Un Bit Slice into a single u32. This is used when creating the round keys.
</span><span class="kw">fn </span>un_bit_slice_4x1_with_u16(bs: <span class="kw-2">&amp;</span>Bs8State&lt;u16&gt;) -&gt; u32 {
    <span class="kw">let </span>(a, <span class="kw">_</span>, <span class="kw">_</span>, <span class="kw">_</span>) = un_bit_slice_4x4_with_u16(bs);
    a
}

<span class="comment">// Un Bit Slice into a 16 byte array
</span><span class="kw">fn </span>un_bit_slice_1x16_with_u16(bs: <span class="kw-2">&amp;</span>Bs8State&lt;u16&gt;, output: <span class="kw-2">&amp;mut </span>[u8]) {
    <span class="kw">let </span>(a, b, c, d) = un_bit_slice_4x4_with_u16(bs);

    write_u32_le(<span class="kw-2">&amp;mut </span>output[<span class="number">0</span>..<span class="number">4</span>], a);
    write_u32_le(<span class="kw-2">&amp;mut </span>output[<span class="number">4</span>..<span class="number">8</span>], b);
    write_u32_le(<span class="kw-2">&amp;mut </span>output[<span class="number">8</span>..<span class="number">12</span>], c);
    write_u32_le(<span class="kw-2">&amp;mut </span>output[<span class="number">12</span>..<span class="number">16</span>], d);
}

<span class="comment">// Bit Slice a 128 byte array of eight 16 byte blocks. Each block is in column major order.
</span><span class="kw">fn </span>bit_slice_1x128_with_u32x4(data: <span class="kw-2">&amp;</span>[u8]) -&gt; Bs8State&lt;u32x4&gt; {
    <span class="kw">let </span>bit0 = u32x4(<span class="number">0x01010101</span>, <span class="number">0x01010101</span>, <span class="number">0x01010101</span>, <span class="number">0x01010101</span>);
    <span class="kw">let </span>bit1 = u32x4(<span class="number">0x02020202</span>, <span class="number">0x02020202</span>, <span class="number">0x02020202</span>, <span class="number">0x02020202</span>);
    <span class="kw">let </span>bit2 = u32x4(<span class="number">0x04040404</span>, <span class="number">0x04040404</span>, <span class="number">0x04040404</span>, <span class="number">0x04040404</span>);
    <span class="kw">let </span>bit3 = u32x4(<span class="number">0x08080808</span>, <span class="number">0x08080808</span>, <span class="number">0x08080808</span>, <span class="number">0x08080808</span>);
    <span class="kw">let </span>bit4 = u32x4(<span class="number">0x10101010</span>, <span class="number">0x10101010</span>, <span class="number">0x10101010</span>, <span class="number">0x10101010</span>);
    <span class="kw">let </span>bit5 = u32x4(<span class="number">0x20202020</span>, <span class="number">0x20202020</span>, <span class="number">0x20202020</span>, <span class="number">0x20202020</span>);
    <span class="kw">let </span>bit6 = u32x4(<span class="number">0x40404040</span>, <span class="number">0x40404040</span>, <span class="number">0x40404040</span>, <span class="number">0x40404040</span>);
    <span class="kw">let </span>bit7 = u32x4(<span class="number">0x80808080</span>, <span class="number">0x80808080</span>, <span class="number">0x80808080</span>, <span class="number">0x80808080</span>);

    <span class="kw">fn </span>read_row_major(data: <span class="kw-2">&amp;</span>[u8]) -&gt; u32x4 {
        u32x4(
            (data[<span class="number">0</span>] <span class="kw">as </span>u32) |
            ((data[<span class="number">4</span>] <span class="kw">as </span>u32) &lt;&lt; <span class="number">8</span>) |
            ((data[<span class="number">8</span>] <span class="kw">as </span>u32) &lt;&lt; <span class="number">16</span>) |
            ((data[<span class="number">12</span>] <span class="kw">as </span>u32) &lt;&lt; <span class="number">24</span>),
            (data[<span class="number">1</span>] <span class="kw">as </span>u32) |
            ((data[<span class="number">5</span>] <span class="kw">as </span>u32) &lt;&lt; <span class="number">8</span>) |
            ((data[<span class="number">9</span>] <span class="kw">as </span>u32) &lt;&lt; <span class="number">16</span>) |
            ((data[<span class="number">13</span>] <span class="kw">as </span>u32) &lt;&lt; <span class="number">24</span>),
            (data[<span class="number">2</span>] <span class="kw">as </span>u32) |
            ((data[<span class="number">6</span>] <span class="kw">as </span>u32) &lt;&lt; <span class="number">8</span>) |
            ((data[<span class="number">10</span>] <span class="kw">as </span>u32) &lt;&lt; <span class="number">16</span>) |
            ((data[<span class="number">14</span>] <span class="kw">as </span>u32) &lt;&lt; <span class="number">24</span>),
            (data[<span class="number">3</span>] <span class="kw">as </span>u32) |
            ((data[<span class="number">7</span>] <span class="kw">as </span>u32) &lt;&lt; <span class="number">8</span>) |
            ((data[<span class="number">11</span>] <span class="kw">as </span>u32) &lt;&lt; <span class="number">16</span>) |
            ((data[<span class="number">15</span>] <span class="kw">as </span>u32) &lt;&lt; <span class="number">24</span>))
    }

    <span class="kw">let </span>t0 = read_row_major(<span class="kw-2">&amp;</span>data[<span class="number">0</span>..<span class="number">16</span>]);
    <span class="kw">let </span>t1 = read_row_major(<span class="kw-2">&amp;</span>data[<span class="number">16</span>..<span class="number">32</span>]);
    <span class="kw">let </span>t2 = read_row_major(<span class="kw-2">&amp;</span>data[<span class="number">32</span>..<span class="number">48</span>]);
    <span class="kw">let </span>t3 = read_row_major(<span class="kw-2">&amp;</span>data[<span class="number">48</span>..<span class="number">64</span>]);
    <span class="kw">let </span>t4 = read_row_major(<span class="kw-2">&amp;</span>data[<span class="number">64</span>..<span class="number">80</span>]);
    <span class="kw">let </span>t5 = read_row_major(<span class="kw-2">&amp;</span>data[<span class="number">80</span>..<span class="number">96</span>]);
    <span class="kw">let </span>t6 = read_row_major(<span class="kw-2">&amp;</span>data[<span class="number">96</span>..<span class="number">112</span>]);
    <span class="kw">let </span>t7 = read_row_major(<span class="kw-2">&amp;</span>data[<span class="number">112</span>..<span class="number">128</span>]);

    <span class="kw">let </span>x0 = (t0 &amp; bit0) | (t1.lsh(<span class="number">1</span>) &amp; bit1) | (t2.lsh(<span class="number">2</span>) &amp; bit2) | (t3.lsh(<span class="number">3</span>) &amp; bit3) |
        (t4.lsh(<span class="number">4</span>) &amp; bit4) | (t5.lsh(<span class="number">5</span>) &amp; bit5) | (t6.lsh(<span class="number">6</span>) &amp; bit6) | (t7.lsh(<span class="number">7</span>) &amp; bit7);
    <span class="kw">let </span>x1 = (t0.rsh(<span class="number">1</span>) &amp; bit0) | (t1 &amp; bit1) | (t2.lsh(<span class="number">1</span>) &amp; bit2) | (t3.lsh(<span class="number">2</span>) &amp; bit3) |
        (t4.lsh(<span class="number">3</span>) &amp; bit4) | (t5.lsh(<span class="number">4</span>) &amp; bit5) | (t6.lsh(<span class="number">5</span>) &amp; bit6) | (t7.lsh(<span class="number">6</span>) &amp; bit7);
    <span class="kw">let </span>x2 = (t0.rsh(<span class="number">2</span>) &amp; bit0) | (t1.rsh(<span class="number">1</span>) &amp; bit1) | (t2 &amp; bit2) | (t3.lsh(<span class="number">1</span>) &amp; bit3) |
        (t4.lsh(<span class="number">2</span>) &amp; bit4) | (t5.lsh(<span class="number">3</span>) &amp; bit5) | (t6.lsh(<span class="number">4</span>) &amp; bit6) | (t7.lsh(<span class="number">5</span>) &amp; bit7);
    <span class="kw">let </span>x3 = (t0.rsh(<span class="number">3</span>) &amp; bit0) | (t1.rsh(<span class="number">2</span>) &amp; bit1) | (t2.rsh(<span class="number">1</span>) &amp; bit2) | (t3 &amp; bit3) |
        (t4.lsh(<span class="number">1</span>) &amp; bit4) | (t5.lsh(<span class="number">2</span>) &amp; bit5) | (t6.lsh(<span class="number">3</span>) &amp; bit6) | (t7.lsh(<span class="number">4</span>) &amp; bit7);
    <span class="kw">let </span>x4 = (t0.rsh(<span class="number">4</span>) &amp; bit0) | (t1.rsh(<span class="number">3</span>) &amp; bit1) | (t2.rsh(<span class="number">2</span>) &amp; bit2) | (t3.rsh(<span class="number">1</span>) &amp; bit3) |
        (t4 &amp; bit4) | (t5.lsh(<span class="number">1</span>) &amp; bit5) | (t6.lsh(<span class="number">2</span>) &amp; bit6) | (t7.lsh(<span class="number">3</span>) &amp; bit7);
    <span class="kw">let </span>x5 = (t0.rsh(<span class="number">5</span>) &amp; bit0) | (t1.rsh(<span class="number">4</span>) &amp; bit1) | (t2.rsh(<span class="number">3</span>) &amp; bit2) | (t3.rsh(<span class="number">2</span>) &amp; bit3) |
        (t4.rsh(<span class="number">1</span>) &amp; bit4) | (t5 &amp; bit5) | (t6.lsh(<span class="number">1</span>) &amp; bit6) | (t7.lsh(<span class="number">2</span>) &amp; bit7);
    <span class="kw">let </span>x6 = (t0.rsh(<span class="number">6</span>) &amp; bit0) | (t1.rsh(<span class="number">5</span>) &amp; bit1) | (t2.rsh(<span class="number">4</span>) &amp; bit2) | (t3.rsh(<span class="number">3</span>) &amp; bit3) |
        (t4.rsh(<span class="number">2</span>) &amp; bit4) | (t5.rsh(<span class="number">1</span>) &amp; bit5) | (t6 &amp; bit6) | (t7.lsh(<span class="number">1</span>) &amp; bit7);
    <span class="kw">let </span>x7 = (t0.rsh(<span class="number">7</span>) &amp; bit0) | (t1.rsh(<span class="number">6</span>) &amp; bit1) | (t2.rsh(<span class="number">5</span>) &amp; bit2) | (t3.rsh(<span class="number">4</span>) &amp; bit3) |
        (t4.rsh(<span class="number">3</span>) &amp; bit4) | (t5.rsh(<span class="number">2</span>) &amp; bit5) | (t6.rsh(<span class="number">1</span>) &amp; bit6) | (t7 &amp; bit7);

    Bs8State(x0, x1, x2, x3, x4, x5, x6, x7)
}

<span class="comment">// Bit slice a set of 4 u32s by filling a full 128 byte data block with those repeated values. This
// is used as part of bit slicing the round keys.
</span><span class="kw">fn </span>bit_slice_fill_4x4_with_u32x4(a: u32, b: u32, c: u32, d: u32) -&gt; Bs8State&lt;u32x4&gt; {
    <span class="kw">let </span><span class="kw-2">mut </span>tmp = [<span class="number">0u8</span>; <span class="number">128</span>];
    <span class="kw">for </span>i <span class="kw">in </span><span class="number">0</span>..<span class="number">8 </span>{
        write_u32_le(<span class="kw-2">&amp;mut </span>tmp[i * <span class="number">16</span>..i * <span class="number">16 </span>+ <span class="number">4</span>], a);
        write_u32_le(<span class="kw-2">&amp;mut </span>tmp[i * <span class="number">16 </span>+ <span class="number">4</span>..i * <span class="number">16 </span>+ <span class="number">8</span>], b);
        write_u32_le(<span class="kw-2">&amp;mut </span>tmp[i * <span class="number">16 </span>+ <span class="number">8</span>..i * <span class="number">16 </span>+ <span class="number">12</span>], c);
        write_u32_le(<span class="kw-2">&amp;mut </span>tmp[i * <span class="number">16 </span>+ <span class="number">12</span>..i * <span class="number">16 </span>+ <span class="number">16</span>], d);
    }
    bit_slice_1x128_with_u32x4(<span class="kw-2">&amp;</span>tmp)
}

<span class="comment">// Un bit slice into a 128 byte buffer.
</span><span class="kw">fn </span>un_bit_slice_1x128_with_u32x4(bs: Bs8State&lt;u32x4&gt;, output: <span class="kw-2">&amp;mut </span>[u8]) {
    <span class="kw">let </span>Bs8State(t0, t1, t2, t3, t4, t5, t6, t7) = bs;

    <span class="kw">let </span>bit0 = u32x4(<span class="number">0x01010101</span>, <span class="number">0x01010101</span>, <span class="number">0x01010101</span>, <span class="number">0x01010101</span>);
    <span class="kw">let </span>bit1 = u32x4(<span class="number">0x02020202</span>, <span class="number">0x02020202</span>, <span class="number">0x02020202</span>, <span class="number">0x02020202</span>);
    <span class="kw">let </span>bit2 = u32x4(<span class="number">0x04040404</span>, <span class="number">0x04040404</span>, <span class="number">0x04040404</span>, <span class="number">0x04040404</span>);
    <span class="kw">let </span>bit3 = u32x4(<span class="number">0x08080808</span>, <span class="number">0x08080808</span>, <span class="number">0x08080808</span>, <span class="number">0x08080808</span>);
    <span class="kw">let </span>bit4 = u32x4(<span class="number">0x10101010</span>, <span class="number">0x10101010</span>, <span class="number">0x10101010</span>, <span class="number">0x10101010</span>);
    <span class="kw">let </span>bit5 = u32x4(<span class="number">0x20202020</span>, <span class="number">0x20202020</span>, <span class="number">0x20202020</span>, <span class="number">0x20202020</span>);
    <span class="kw">let </span>bit6 = u32x4(<span class="number">0x40404040</span>, <span class="number">0x40404040</span>, <span class="number">0x40404040</span>, <span class="number">0x40404040</span>);
    <span class="kw">let </span>bit7 = u32x4(<span class="number">0x80808080</span>, <span class="number">0x80808080</span>, <span class="number">0x80808080</span>, <span class="number">0x80808080</span>);

    <span class="comment">// decode the individual blocks, in row-major order
    // TODO: this is identical to the same block in bit_slice_1x128_with_u32x4
    </span><span class="kw">let </span>x0 = (t0 &amp; bit0) | (t1.lsh(<span class="number">1</span>) &amp; bit1) | (t2.lsh(<span class="number">2</span>) &amp; bit2) | (t3.lsh(<span class="number">3</span>) &amp; bit3) |
        (t4.lsh(<span class="number">4</span>) &amp; bit4) | (t5.lsh(<span class="number">5</span>) &amp; bit5) | (t6.lsh(<span class="number">6</span>) &amp; bit6) | (t7.lsh(<span class="number">7</span>) &amp; bit7);
    <span class="kw">let </span>x1 = (t0.rsh(<span class="number">1</span>) &amp; bit0) | (t1 &amp; bit1) | (t2.lsh(<span class="number">1</span>) &amp; bit2) | (t3.lsh(<span class="number">2</span>) &amp; bit3) |
        (t4.lsh(<span class="number">3</span>) &amp; bit4) | (t5.lsh(<span class="number">4</span>) &amp; bit5) | (t6.lsh(<span class="number">5</span>) &amp; bit6) | (t7.lsh(<span class="number">6</span>) &amp; bit7);
    <span class="kw">let </span>x2 = (t0.rsh(<span class="number">2</span>) &amp; bit0) | (t1.rsh(<span class="number">1</span>) &amp; bit1) | (t2 &amp; bit2) | (t3.lsh(<span class="number">1</span>) &amp; bit3) |
        (t4.lsh(<span class="number">2</span>) &amp; bit4) | (t5.lsh(<span class="number">3</span>) &amp; bit5) | (t6.lsh(<span class="number">4</span>) &amp; bit6) | (t7.lsh(<span class="number">5</span>) &amp; bit7);
    <span class="kw">let </span>x3 = (t0.rsh(<span class="number">3</span>) &amp; bit0) | (t1.rsh(<span class="number">2</span>) &amp; bit1) | (t2.rsh(<span class="number">1</span>) &amp; bit2) | (t3 &amp; bit3) |
        (t4.lsh(<span class="number">1</span>) &amp; bit4) | (t5.lsh(<span class="number">2</span>) &amp; bit5) | (t6.lsh(<span class="number">3</span>) &amp; bit6) | (t7.lsh(<span class="number">4</span>) &amp; bit7);
    <span class="kw">let </span>x4 = (t0.rsh(<span class="number">4</span>) &amp; bit0) | (t1.rsh(<span class="number">3</span>) &amp; bit1) | (t2.rsh(<span class="number">2</span>) &amp; bit2) | (t3.rsh(<span class="number">1</span>) &amp; bit3) |
        (t4 &amp; bit4) | (t5.lsh(<span class="number">1</span>) &amp; bit5) | (t6.lsh(<span class="number">2</span>) &amp; bit6) | (t7.lsh(<span class="number">3</span>) &amp; bit7);
    <span class="kw">let </span>x5 = (t0.rsh(<span class="number">5</span>) &amp; bit0) | (t1.rsh(<span class="number">4</span>) &amp; bit1) | (t2.rsh(<span class="number">3</span>) &amp; bit2) | (t3.rsh(<span class="number">2</span>) &amp; bit3) |
        (t4.rsh(<span class="number">1</span>) &amp; bit4) | (t5 &amp; bit5) | (t6.lsh(<span class="number">1</span>) &amp; bit6) | (t7.lsh(<span class="number">2</span>) &amp; bit7);
    <span class="kw">let </span>x6 = (t0.rsh(<span class="number">6</span>) &amp; bit0) | (t1.rsh(<span class="number">5</span>) &amp; bit1) | (t2.rsh(<span class="number">4</span>) &amp; bit2) | (t3.rsh(<span class="number">3</span>) &amp; bit3) |
        (t4.rsh(<span class="number">2</span>) &amp; bit4) | (t5.rsh(<span class="number">1</span>) &amp; bit5) | (t6 &amp; bit6) | (t7.lsh(<span class="number">1</span>) &amp; bit7);
    <span class="kw">let </span>x7 = (t0.rsh(<span class="number">7</span>) &amp; bit0) | (t1.rsh(<span class="number">6</span>) &amp; bit1) | (t2.rsh(<span class="number">5</span>) &amp; bit2) | (t3.rsh(<span class="number">4</span>) &amp; bit3) |
        (t4.rsh(<span class="number">3</span>) &amp; bit4) | (t5.rsh(<span class="number">2</span>) &amp; bit5) | (t6.rsh(<span class="number">1</span>) &amp; bit6) | (t7 &amp; bit7);

    <span class="kw">fn </span>write_row_major(block: u32x4, output: <span class="kw-2">&amp;mut </span>[u8]) {
        <span class="kw">let </span>u32x4(a0, a1, a2, a3) = block;
        output[<span class="number">0</span>] = a0 <span class="kw">as </span>u8;
        output[<span class="number">1</span>] = a1 <span class="kw">as </span>u8;
        output[<span class="number">2</span>] = a2 <span class="kw">as </span>u8;
        output[<span class="number">3</span>] = a3 <span class="kw">as </span>u8;
        output[<span class="number">4</span>] = (a0 &gt;&gt; <span class="number">8</span>) <span class="kw">as </span>u8;
        output[<span class="number">5</span>] = (a1 &gt;&gt; <span class="number">8</span>) <span class="kw">as </span>u8;
        output[<span class="number">6</span>] = (a2 &gt;&gt; <span class="number">8</span>) <span class="kw">as </span>u8;
        output[<span class="number">7</span>] = (a3 &gt;&gt; <span class="number">8</span>) <span class="kw">as </span>u8;
        output[<span class="number">8</span>] = (a0 &gt;&gt; <span class="number">16</span>) <span class="kw">as </span>u8;
        output[<span class="number">9</span>] = (a1 &gt;&gt; <span class="number">16</span>) <span class="kw">as </span>u8;
        output[<span class="number">10</span>] = (a2 &gt;&gt; <span class="number">16</span>) <span class="kw">as </span>u8;
        output[<span class="number">11</span>] = (a3 &gt;&gt; <span class="number">16</span>) <span class="kw">as </span>u8;
        output[<span class="number">12</span>] = (a0 &gt;&gt; <span class="number">24</span>) <span class="kw">as </span>u8;
        output[<span class="number">13</span>] = (a1 &gt;&gt; <span class="number">24</span>) <span class="kw">as </span>u8;
        output[<span class="number">14</span>] = (a2 &gt;&gt; <span class="number">24</span>) <span class="kw">as </span>u8;
        output[<span class="number">15</span>] = (a3 &gt;&gt; <span class="number">24</span>) <span class="kw">as </span>u8;
    }

    write_row_major(x0, <span class="kw-2">&amp;mut </span>output[<span class="number">0</span>..<span class="number">16</span>]);
    write_row_major(x1, <span class="kw-2">&amp;mut </span>output[<span class="number">16</span>..<span class="number">32</span>]);
    write_row_major(x2, <span class="kw-2">&amp;mut </span>output[<span class="number">32</span>..<span class="number">48</span>]);
    write_row_major(x3, <span class="kw-2">&amp;mut </span>output[<span class="number">48</span>..<span class="number">64</span>]);
    write_row_major(x4, <span class="kw-2">&amp;mut </span>output[<span class="number">64</span>..<span class="number">80</span>]);
    write_row_major(x5, <span class="kw-2">&amp;mut </span>output[<span class="number">80</span>..<span class="number">96</span>]);
    write_row_major(x6, <span class="kw-2">&amp;mut </span>output[<span class="number">96</span>..<span class="number">112</span>]);
    write_row_major(x7, <span class="kw-2">&amp;mut </span>output[<span class="number">112</span>..<span class="number">128</span>])
}

<span class="comment">// The Gf2Ops, Gf4Ops, and Gf8Ops traits specify the functions needed to calculate the AES S-Box
// values. This particuar implementation of those S-Box values is taken from [7], so that is where
// to look for details on how all that all works. This includes the transformations matrices defined
// below for the change_basis operation on the u32 and u32x4 types.

// Operations in GF(2^2) using normal basis (Omega^2,Omega)
</span><span class="kw">trait </span>Gf2Ops {
    <span class="comment">// multiply
    </span><span class="kw">fn </span>mul(<span class="self">self</span>, y: <span class="self">Self</span>) -&gt; <span class="self">Self</span>;

    <span class="comment">// scale by N = Omega^2
    </span><span class="kw">fn </span>scl_n(<span class="self">self</span>) -&gt; <span class="self">Self</span>;

    <span class="comment">// scale by N^2 = Omega
    </span><span class="kw">fn </span>scl_n2(<span class="self">self</span>) -&gt; <span class="self">Self</span>;

    <span class="comment">// square
    </span><span class="kw">fn </span>sq(<span class="self">self</span>) -&gt; <span class="self">Self</span>;

    <span class="comment">// Same as sqaure
    </span><span class="kw">fn </span>inv(<span class="self">self</span>) -&gt; <span class="self">Self</span>;
}

<span class="kw">impl </span>&lt;T: BitXor&lt;Output = T&gt; + BitAnd&lt;Output = T&gt; + Copy&gt; Gf2Ops <span class="kw">for </span>Bs2State&lt;T&gt; {
    <span class="kw">fn </span>mul(<span class="self">self</span>, y: Bs2State&lt;T&gt;) -&gt; Bs2State&lt;T&gt; {
        <span class="kw">let </span>(b, a) = <span class="self">self</span>.split();
        <span class="kw">let </span>(d, c) = y.split();
        <span class="kw">let </span>e = (a ^ b) &amp; (c ^ d);
        <span class="kw">let </span>p = (a &amp; c) ^ e;
        <span class="kw">let </span>q = (b &amp; d) ^ e;
        Bs2State(q, p)
    }

    <span class="kw">fn </span>scl_n(<span class="self">self</span>) -&gt; Bs2State&lt;T&gt; {
        <span class="kw">let </span>(b, a) = <span class="self">self</span>.split();
        <span class="kw">let </span>q = a ^ b;
        Bs2State(q, b)
    }

    <span class="kw">fn </span>scl_n2(<span class="self">self</span>) -&gt; Bs2State&lt;T&gt; {
        <span class="kw">let </span>(b, a) = <span class="self">self</span>.split();
        <span class="kw">let </span>p = a ^ b;
        <span class="kw">let </span>q = a;
        Bs2State(q, p)
    }

    <span class="kw">fn </span>sq(<span class="self">self</span>) -&gt; Bs2State&lt;T&gt; {
        <span class="kw">let </span>(b, a) = <span class="self">self</span>.split();
        Bs2State(a, b)
    }

    <span class="kw">fn </span>inv(<span class="self">self</span>) -&gt; Bs2State&lt;T&gt; {
        <span class="self">self</span>.sq()
    }
}

<span class="comment">// Operations in GF(2^4) using normal basis (alpha^8,alpha^2)
</span><span class="kw">trait </span>Gf4Ops {
    <span class="comment">// multiply
    </span><span class="kw">fn </span>mul(<span class="self">self</span>, y: <span class="self">Self</span>) -&gt; <span class="self">Self</span>;

    <span class="comment">// square &amp; scale by nu
    // nu = beta^8 = N^2*alpha^2, N = w^2
    </span><span class="kw">fn </span>sq_scl(<span class="self">self</span>) -&gt; <span class="self">Self</span>;

    <span class="comment">// inverse
    </span><span class="kw">fn </span>inv(<span class="self">self</span>) -&gt; <span class="self">Self</span>;
}

<span class="kw">impl </span>&lt;T: BitXor&lt;Output = T&gt; + BitAnd&lt;Output = T&gt; + Copy&gt; Gf4Ops <span class="kw">for </span>Bs4State&lt;T&gt; {
    <span class="kw">fn </span>mul(<span class="self">self</span>, y: Bs4State&lt;T&gt;) -&gt; Bs4State&lt;T&gt; {
        <span class="kw">let </span>(b, a) = <span class="self">self</span>.split();
        <span class="kw">let </span>(d, c) = y.split();
        <span class="kw">let </span>f = c.xor(d);
        <span class="kw">let </span>e = a.xor(b).mul(f).scl_n();
        <span class="kw">let </span>p = a.mul(c).xor(e);
        <span class="kw">let </span>q = b.mul(d).xor(e);
        q.join(p)
    }

    <span class="kw">fn </span>sq_scl(<span class="self">self</span>) -&gt; Bs4State&lt;T&gt; {
        <span class="kw">let </span>(b, a) = <span class="self">self</span>.split();
        <span class="kw">let </span>p = a.xor(b).sq();
        <span class="kw">let </span>q = b.sq().scl_n2();
        q.join(p)
    }

    <span class="kw">fn </span>inv(<span class="self">self</span>) -&gt; Bs4State&lt;T&gt; {
        <span class="kw">let </span>(b, a) = <span class="self">self</span>.split();
        <span class="kw">let </span>c = a.xor(b).sq().scl_n();
        <span class="kw">let </span>d = a.mul(b);
        <span class="kw">let </span>e = c.xor(d).inv();
        <span class="kw">let </span>p = e.mul(b);
        <span class="kw">let </span>q = e.mul(a);
        q.join(p)
    }
}

<span class="comment">// Operations in GF(2^8) using normal basis (d^16,d)
</span><span class="kw">trait </span>Gf8Ops {
    <span class="comment">// inverse
    </span><span class="kw">fn </span>inv(<span class="kw-2">&amp;</span><span class="self">self</span>) -&gt; <span class="self">Self</span>;
}

<span class="kw">impl </span>&lt;T: BitXor&lt;Output = T&gt; + BitAnd&lt;Output = T&gt; + Copy + Default&gt; Gf8Ops <span class="kw">for </span>Bs8State&lt;T&gt; {
    <span class="kw">fn </span>inv(<span class="kw-2">&amp;</span><span class="self">self</span>) -&gt; Bs8State&lt;T&gt; {
        <span class="kw">let </span>(b, a) = <span class="self">self</span>.split();
        <span class="kw">let </span>c = a.xor(b).sq_scl();
        <span class="kw">let </span>d = a.mul(b);
        <span class="kw">let </span>e = c.xor(d).inv();
        <span class="kw">let </span>p = e.mul(b);
        <span class="kw">let </span>q = e.mul(a);
        q.join(p)
    }
}

<span class="kw">impl </span>&lt;T: AesBitValueOps + Copy + <span class="lifetime">&#39;static</span>&gt; AesOps <span class="kw">for </span>Bs8State&lt;T&gt; {
    <span class="kw">fn </span>sub_bytes(<span class="self">self</span>) -&gt; Bs8State&lt;T&gt; {
        <span class="kw">let </span>nb: Bs8State&lt;T&gt; = <span class="self">self</span>.change_basis_a2x();
        <span class="kw">let </span>inv = nb.inv();
        <span class="kw">let </span>nb2: Bs8State&lt;T&gt; = inv.change_basis_x2s();
        nb2.xor_x63()
    }

    <span class="kw">fn </span>inv_sub_bytes(<span class="self">self</span>) -&gt; Bs8State&lt;T&gt; {
        <span class="kw">let </span>t = <span class="self">self</span>.xor_x63();
        <span class="kw">let </span>nb: Bs8State&lt;T&gt; = t.change_basis_s2x();
        <span class="kw">let </span>inv = nb.inv();
        inv.change_basis_x2a()
    }

    <span class="kw">fn </span>shift_rows(<span class="self">self</span>) -&gt; Bs8State&lt;T&gt; {
        <span class="kw">let </span>Bs8State(x0, x1, x2, x3, x4, x5, x6, x7) = <span class="self">self</span>;
        Bs8State(
            x0.shift_row(),
            x1.shift_row(),
            x2.shift_row(),
            x3.shift_row(),
            x4.shift_row(),
            x5.shift_row(),
            x6.shift_row(),
            x7.shift_row())
    }

    <span class="kw">fn </span>inv_shift_rows(<span class="self">self</span>) -&gt; Bs8State&lt;T&gt; {
        <span class="kw">let </span>Bs8State(x0, x1, x2, x3, x4, x5, x6, x7) = <span class="self">self</span>;
        Bs8State(
            x0.inv_shift_row(),
            x1.inv_shift_row(),
            x2.inv_shift_row(),
            x3.inv_shift_row(),
            x4.inv_shift_row(),
            x5.inv_shift_row(),
            x6.inv_shift_row(),
            x7.inv_shift_row())
    }

    <span class="comment">// Formula from [5]
    </span><span class="kw">fn </span>mix_columns(<span class="self">self</span>) -&gt; Bs8State&lt;T&gt; {
        <span class="kw">let </span>Bs8State(x0, x1, x2, x3, x4, x5, x6, x7) = <span class="self">self</span>;

        <span class="kw">let </span>x0out = x7 ^ x7.ror1() ^ x0.ror1() ^ (x0 ^ x0.ror1()).ror2();
        <span class="kw">let </span>x1out = x0 ^ x0.ror1() ^ x7 ^ x7.ror1() ^ x1.ror1() ^ (x1 ^ x1.ror1()).ror2();
        <span class="kw">let </span>x2out = x1 ^ x1.ror1() ^ x2.ror1() ^ (x2 ^ x2.ror1()).ror2();
        <span class="kw">let </span>x3out = x2 ^ x2.ror1() ^ x7 ^ x7.ror1() ^ x3.ror1() ^ (x3 ^ x3.ror1()).ror2();
        <span class="kw">let </span>x4out = x3 ^ x3.ror1() ^ x7 ^ x7.ror1() ^ x4.ror1() ^ (x4 ^ x4.ror1()).ror2();
        <span class="kw">let </span>x5out = x4 ^ x4.ror1() ^ x5.ror1() ^ (x5 ^ x5.ror1()).ror2();
        <span class="kw">let </span>x6out = x5 ^ x5.ror1() ^ x6.ror1() ^ (x6 ^ x6.ror1()).ror2();
        <span class="kw">let </span>x7out = x6 ^ x6.ror1() ^ x7.ror1() ^ (x7 ^ x7.ror1()).ror2();

        Bs8State(x0out, x1out, x2out, x3out, x4out, x5out, x6out, x7out)
    }

    <span class="comment">// Formula from [6]
    </span><span class="kw">fn </span>inv_mix_columns(<span class="self">self</span>) -&gt; Bs8State&lt;T&gt; {
        <span class="kw">let </span>Bs8State(x0, x1, x2, x3, x4, x5, x6, x7) = <span class="self">self</span>;

        <span class="kw">let </span>x0out = x5 ^ x6 ^ x7 ^
            (x5 ^ x7 ^ x0).ror1() ^
            (x0 ^ x5 ^ x6).ror2() ^
            (x5 ^ x0).ror3();
        <span class="kw">let </span>x1out = x5 ^ x0 ^
            (x6 ^ x5 ^ x0 ^ x7 ^ x1).ror1() ^
            (x1 ^ x7 ^ x5).ror2() ^
            (x6 ^ x5 ^ x1).ror3();
        <span class="kw">let </span>x2out = x6 ^ x0 ^ x1 ^
            (x7 ^ x6 ^ x1 ^ x2).ror1() ^
            (x0 ^ x2 ^ x6).ror2() ^
            (x7 ^ x6 ^ x2).ror3();
        <span class="kw">let </span>x3out = x0 ^ x5 ^ x1 ^ x6 ^ x2 ^
            (x0 ^ x5 ^ x2 ^ x3).ror1() ^
            (x0 ^ x1 ^ x3 ^ x5 ^ x6 ^ x7).ror2() ^
            (x0 ^ x5 ^ x7 ^ x3).ror3();
        <span class="kw">let </span>x4out = x1 ^ x5 ^ x2 ^ x3 ^
            (x1 ^ x6 ^ x5 ^ x3 ^ x7 ^ x4).ror1() ^
            (x1 ^ x2 ^ x4 ^ x5 ^ x7).ror2() ^
            (x1 ^ x5 ^ x6 ^ x4).ror3();
        <span class="kw">let </span>x5out = x2 ^ x6 ^ x3 ^ x4 ^
            (x2 ^ x7 ^ x6 ^ x4 ^ x5).ror1() ^
            (x2 ^ x3 ^ x5 ^ x6).ror2() ^
            (x2 ^ x6 ^ x7 ^ x5).ror3();
        <span class="kw">let </span>x6out =  x3 ^ x7 ^ x4 ^ x5 ^
            (x3 ^ x7 ^ x5 ^ x6).ror1() ^
            (x3 ^ x4 ^ x6 ^ x7).ror2() ^
            (x3 ^ x7 ^ x6).ror3();
        <span class="kw">let </span>x7out = x4 ^ x5 ^ x6 ^
            (x4 ^ x6 ^ x7).ror1() ^
            (x4 ^ x5 ^ x7).ror2() ^
            (x4 ^ x7).ror3();

        Bs8State(x0out, x1out, x2out, x3out, x4out, x5out, x6out, x7out)
    }

    <span class="kw">fn </span>add_round_key(<span class="self">self</span>, rk: <span class="kw-2">&amp;</span>Bs8State&lt;T&gt;) -&gt; Bs8State&lt;T&gt; {
        <span class="self">self</span>.xor(<span class="kw-2">*</span>rk)
    }
}

<span class="kw">trait </span>AesBitValueOps: BitXor&lt;Output = <span class="self">Self</span>&gt; + BitAnd&lt;Output = <span class="self">Self</span>&gt; + Not&lt;Output = <span class="self">Self</span>&gt; + Default + Sized {
    <span class="kw">fn </span>shift_row(<span class="self">self</span>) -&gt; <span class="self">Self</span>;
    <span class="kw">fn </span>inv_shift_row(<span class="self">self</span>) -&gt; <span class="self">Self</span>;
    <span class="kw">fn </span>ror1(<span class="self">self</span>) -&gt; <span class="self">Self</span>;
    <span class="kw">fn </span>ror2(<span class="self">self</span>) -&gt; <span class="self">Self</span>;
    <span class="kw">fn </span>ror3(<span class="self">self</span>) -&gt; <span class="self">Self</span>;
}

<span class="kw">impl </span>AesBitValueOps <span class="kw">for </span>u16 {
    <span class="kw">fn </span>shift_row(<span class="self">self</span>) -&gt; u16 {
        <span class="comment">// first 4 bits represent first row - don&#39;t shift
        </span>(<span class="self">self </span>&amp; <span class="number">0x000f</span>) |
        <span class="comment">// next 4 bits represent 2nd row - left rotate 1 bit
        </span>((<span class="self">self </span>&amp; <span class="number">0x00e0</span>) &gt;&gt; <span class="number">1</span>) | ((<span class="self">self </span>&amp; <span class="number">0x0010</span>) &lt;&lt; <span class="number">3</span>) |
        <span class="comment">// next 4 bits represent 3rd row - left rotate 2 bits
        </span>((<span class="self">self </span>&amp; <span class="number">0x0c00</span>) &gt;&gt; <span class="number">2</span>) | ((<span class="self">self </span>&amp; <span class="number">0x0300</span>) &lt;&lt; <span class="number">2</span>) |
        <span class="comment">// next 4 bits represent 4th row - left rotate 3 bits
        </span>((<span class="self">self </span>&amp; <span class="number">0x8000</span>) &gt;&gt; <span class="number">3</span>) | ((<span class="self">self </span>&amp; <span class="number">0x7000</span>) &lt;&lt; <span class="number">1</span>)
    }

    <span class="kw">fn </span>inv_shift_row(<span class="self">self</span>) -&gt; u16 {
        <span class="comment">// first 4 bits represent first row - don&#39;t shift
        </span>(<span class="self">self </span>&amp; <span class="number">0x000f</span>) |
        <span class="comment">// next 4 bits represent 2nd row - right rotate 1 bit
        </span>((<span class="self">self </span>&amp; <span class="number">0x0080</span>) &gt;&gt; <span class="number">3</span>) | ((<span class="self">self </span>&amp; <span class="number">0x0070</span>) &lt;&lt; <span class="number">1</span>) |
        <span class="comment">// next 4 bits represent 3rd row - right rotate 2 bits
        </span>((<span class="self">self </span>&amp; <span class="number">0x0c00</span>) &gt;&gt; <span class="number">2</span>) | ((<span class="self">self </span>&amp; <span class="number">0x0300</span>) &lt;&lt; <span class="number">2</span>) |
        <span class="comment">// next 4 bits represent 4th row - right rotate 3 bits
        </span>((<span class="self">self </span>&amp; <span class="number">0xe000</span>) &gt;&gt; <span class="number">1</span>) | ((<span class="self">self </span>&amp; <span class="number">0x1000</span>) &lt;&lt; <span class="number">3</span>)
    }

    <span class="kw">fn </span>ror1(<span class="self">self</span>) -&gt; u16 {
        <span class="self">self </span>&gt;&gt; <span class="number">4 </span>| <span class="self">self </span>&lt;&lt; <span class="number">12
    </span>}

    <span class="kw">fn </span>ror2(<span class="self">self</span>) -&gt; u16 {
        <span class="self">self </span>&gt;&gt; <span class="number">8 </span>| <span class="self">self </span>&lt;&lt; <span class="number">8
    </span>}

    <span class="kw">fn </span>ror3(<span class="self">self</span>) -&gt; u16 {
        <span class="self">self </span>&gt;&gt; <span class="number">12 </span>| <span class="self">self </span>&lt;&lt; <span class="number">4
    </span>}
}

<span class="kw">impl </span>u32x4 {
    <span class="kw">fn </span>lsh(<span class="self">self</span>, s: u32) -&gt; u32x4 {
        <span class="kw">let </span>u32x4(a0, a1, a2, a3) = <span class="self">self</span>;
        u32x4(
            a0 &lt;&lt; s,
            (a1 &lt;&lt; s) | (a0 &gt;&gt; (<span class="number">32 </span>- s)),
            (a2 &lt;&lt; s) | (a1 &gt;&gt; (<span class="number">32 </span>- s)),
            (a3 &lt;&lt; s) | (a2 &gt;&gt; (<span class="number">32 </span>- s)))
    }

    <span class="kw">fn </span>rsh(<span class="self">self</span>, s: u32) -&gt; u32x4 {
        <span class="kw">let </span>u32x4(a0, a1, a2, a3) = <span class="self">self</span>;
        u32x4(
            (a0 &gt;&gt; s) | (a1 &lt;&lt; (<span class="number">32 </span>- s)),
            (a1 &gt;&gt; s) | (a2 &lt;&lt; (<span class="number">32 </span>- s)),
            (a2 &gt;&gt; s) | (a3 &lt;&lt; (<span class="number">32 </span>- s)),
            a3 &gt;&gt; s)
    }
}

<span class="kw">impl </span>Not <span class="kw">for </span>u32x4 {
    <span class="kw">type </span>Output = u32x4;

    <span class="kw">fn </span>not(<span class="self">self</span>) -&gt; u32x4 {
        <span class="self">self </span>^ U32X4_1
    }
}

<span class="kw">impl </span>Default <span class="kw">for </span>u32x4 {
    <span class="kw">fn </span>default() -&gt; u32x4 {
        u32x4(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)
    }
}

<span class="kw">impl </span>AesBitValueOps <span class="kw">for </span>u32x4 {
    <span class="kw">fn </span>shift_row(<span class="self">self</span>) -&gt; u32x4 {
        <span class="kw">let </span>u32x4(a0, a1, a2, a3) = <span class="self">self</span>;
        u32x4(a0, a1 &gt;&gt; <span class="number">8 </span>| a1 &lt;&lt; <span class="number">24</span>, a2 &gt;&gt; <span class="number">16 </span>| a2 &lt;&lt; <span class="number">16</span>, a3 &gt;&gt; <span class="number">24 </span>| a3 &lt;&lt; <span class="number">8</span>)
    }

    <span class="kw">fn </span>inv_shift_row(<span class="self">self</span>) -&gt; u32x4 {
        <span class="kw">let </span>u32x4(a0, a1, a2, a3) = <span class="self">self</span>;
        u32x4(a0, a1 &gt;&gt; <span class="number">24 </span>| a1 &lt;&lt; <span class="number">8</span>, a2 &gt;&gt; <span class="number">16 </span>| a2 &lt;&lt; <span class="number">16</span>, a3 &gt;&gt; <span class="number">8 </span>| a3 &lt;&lt; <span class="number">24</span>)
    }

    <span class="kw">fn </span>ror1(<span class="self">self</span>) -&gt; u32x4 {
        <span class="kw">let </span>u32x4(a0, a1, a2, a3) = <span class="self">self</span>;
        u32x4(a1, a2, a3, a0)
    }

    <span class="kw">fn </span>ror2(<span class="self">self</span>) -&gt; u32x4 {
        <span class="kw">let </span>u32x4(a0, a1, a2, a3) = <span class="self">self</span>;
        u32x4(a2, a3, a0, a1)
    }

    <span class="kw">fn </span>ror3(<span class="self">self</span>) -&gt; u32x4 {
        <span class="kw">let </span>u32x4(a0, a1, a2, a3) = <span class="self">self</span>;
        u32x4(a3, a0, a1, a2)
    }
}
</code></pre></div></section></main></body></html>